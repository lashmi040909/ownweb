<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>李诗淼的秘密花园</title>
    <style>
        :root {
            --dark-green: #2E7D32;
            --light-green: #4CAF50;
            --bright-pink: #FF69B4;
            --soft-pink: #FFC0CB;
            --lighter-yellow: #FFF8E1;
            --light-pink: #FFB6C1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        /* 封面页面样式 */
        .cover-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease;
        }

        .cover-text {
            text-align: center;
            color: #333;
            position: relative;
            z-index: 1002;
        }

        .chinese-text {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .english-text {
            font-size: 24px;
            font-style: italic;
        }

        /* 定义文字区域的安全范围 */
        .safe-zone {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 400px;
            height: 200px;
            z-index: 1001;
        }

        /* 可点击区域样式 */
        .click-area {
            position: absolute;
            width: 350px;
            height: 350px;
            cursor: pointer;
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #333;
            font-weight: bold;
            z-index: 1001;
        }

        .click-area:hover {
            transform: scale(1.1);
        }

        .click-area img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .click-area span {
            display: none;
        }

        .camera-area, .cat-area, .notebook-area, .palette-area {
            position: absolute;
        }

        .camera-area {
            top: 5%;
            left: 5%;
        }

        .camera-area span {
            display: none;
        }

        .cat-area {
            top: 5%;
            right: 5%;
        }

        .notebook-area {
            bottom: 5%;
            left: 5%;
        }

        .palette-area {
            bottom: 5%;
            right: 5%;
        }

        .main-content {
            display: none;
        }

        :root {
            --dark-green: #2E7D32;
            --light-green: #4CAF50;
            --bright-pink: #FF69B4;
            --soft-pink: #FFC0CB;
            --lighter-yellow: #FFF8E1;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            min-height: 100vh;
            background: rgba(255, 255, 255, 0.9);
        }

        .bg-pattern {
            background: none;
        }

        .navigation {
            background: rgba(255, 255, 255, 0.9);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-list {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 2rem;
        }

        .nav-item {
            padding: 0.5rem 1rem;
            color: var(--dark-green);
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .nav-item:hover, .nav-item.active {
            background: var(--bright-pink);
            color: white;
            transform: translateY(-2px);
        }

        .container {
            position: relative;
            z-index: 1;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            backdrop-filter: blur(5px);
            margin: 2rem auto;
            padding: 3rem 4rem;
            max-width: 1200px;
            width: 85%;
        }

        .page {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
            position: relative;
            z-index: 1;
        }

        .page.active {
            display: block;
            opacity: 1;
        }

        /* 首页样式 */
        .welcome-section {
            text-align: center;
            padding: 6rem 0;
            position: relative;
            margin-left: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
        }

        .welcome-title {
            font-family: 'Arial', cursive;
            color: #4CAF50;
            font-size: 5rem;
            margin-bottom: 2rem;
            line-height: 1.4;
            font-weight: bold;
            text-transform: none;
            animation: none;
            text-align: center;
        }

        .welcome-subtitle {
            color: #2E7D32;
            font-size: 2rem;
            margin-bottom: 1rem;
            opacity: 0.8;
        }

        .category-text {
            display: flex;
            justify-content: center;
            margin-top: 4rem;
            font-size: 2.5rem;
            color: #4CAF50;
            opacity: 0.7;
            width: 100%;
        }

        .category-text span {
            margin: 0 4rem;
            position: relative;
        }

        .category-text span::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 2px;
            background: #4CAF50;
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .category-text span:hover::after {
            transform: scaleX(1);
        }

        .life-gallery {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2.5rem;
            padding: 2rem 0;
            max-width: 1000px;
            margin: 0 auto;
        }

        .gallery-item {
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
        }

        .gallery-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.2);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            padding: 1.5rem;
            color: white;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
            transform: translateY(0);
        }

        .gallery-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        .gallery-description {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .gallery-category {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--bright-pink);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .container {
                padding: 2rem;
                width: 90%;
            }
            
            .life-gallery {
                grid-template-columns: repeat(2, 1fr);
                gap: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 1.5rem;
                width: 95%;
            }
            
            .life-gallery {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: var(--lighter-yellow);
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        /* 关于页面样式 */
        .bg-lighter-yellow {
            background-color: rgba(255, 248, 225, 0.8);
            backdrop-filter: blur(5px);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .bg-lighter-yellow:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .text-dark-green {
            color: var(--dark-green);
        }

        .text-bright-pink {
            color: var(--bright-pink);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2.5rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        @media (min-width: 768px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .hover-glow {
            transition: all 0.3s ease;
        }

        .hover-glow:hover {
            box-shadow: 0 0 15px rgba(255, 105, 180, 0.3);
        }

        .cursor-pointer {
            cursor: pointer;
        }

        .image-container {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
            aspect-ratio: 1;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .image-container:hover img {
            transform: scale(1.1);
        }

        .image-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .image-container:hover .image-overlay {
            opacity: 1;
        }

        .social-card {
            opacity: 0.5;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .social-card.active {
            opacity: 1;
            transform: translateY(0);
        }

        .social-link {
            display: block;
            padding: 0.5rem;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            transform: translateX(10px);
            color: var(--bright-pink);
        }

        .works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        /* 有趣的事页面样式 */
        .maze-container {
            background: var(--lighter-yellow);
            padding: 3rem;
            border-radius: 1.5rem;
            margin: 2rem auto;
            max-width: 600px;
            text-align: center;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #maze {
            display: grid;
            gap: 2px;
            background: #ddd;
            padding: 15px;
            border-radius: 15px;
            margin: 1rem auto;
            width: 100%;
            height: 100%;
            aspect-ratio: 1;
        }

        .maze-cell {
            width: 100%;
            height: 100%;
            background: white;
            transition: all 0.3s ease;
            border-radius: 5px;
            min-width: 0;
            min-height: 0;
        }

        .wall { 
            background: var(--dark-green);
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
        }

        .path { 
            background: var(--soft-pink);
            box-shadow: inset 0 0 5px rgba(255,255,255,0.5);
        }

        .start { 
            background: var(--light-green);
            box-shadow: 0 0 15px rgba(76,175,80,0.3);
        }

        .end { 
            background: var(--bright-pink);
            box-shadow: 0 0 15px rgba(255,105,180,0.3);
        }

        .cat { 
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="%23808080"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="%23808080"/><path d="M6,3 h4 v1 h-4 z" fill="%23808080"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="%23808080"/><circle cx="6" cy="8" r="1" fill="white"/><circle cx="10" cy="8" r="1" fill="white"/><path d="M7,10 h2 v1 h-2 z" fill="white"/></svg>') no-repeat center/contain;
            background-size: 80%;
            animation: catBounce 0.3s ease;
        }

        @keyframes catBounce {
            0% { transform: scale(0.8); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        #mazeInfo {
            font-size: 1.2rem;
            margin: 1.5rem 0;
            color: var(--dark-green);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .maze-container .adopt-button {
            font-size: 1.1rem;
            padding: 0.8rem 2rem;
            margin-top: 2rem;
            background: var(--dark-green);
            color: white;
            border: none;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .maze-container .adopt-button:hover {
            background: var(--bright-pink);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .pet-garden {
            text-align: center;
            margin: 2rem auto;
            max-width: 800px;
        }

        .pet-card {
            display: inline-block;
            margin: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            text-align: center;
        }

        .pet-card:hover {
            transform: translateY(-5px);
        }

        .pet-image {
            width: 120px;
            height: 120px;
            margin: 0 auto 1rem;
            background-size: contain;
            image-rendering: pixelated;
            background-repeat: no-repeat;
            background-position: center;
            border: 2px solid #E8F5E9;
            border-radius: 10px;
            padding: 10px;
        }

        .pet-name {
            color: var(--dark-green);
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }

        .adopt-button {
            background: var(--dark-green);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .adopt-button:hover {
            background: var(--bright-pink);
            transform: scale(1.05);
        }

        /* 模态框样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .modal-overlay.show {
            opacity: 1;
        }

        .modal {
            background: var(--lighter-yellow);
            padding: 2rem;
            border-radius: 1rem;
            position: relative;
            max-width: 900px;
            width: 90%;
            margin: 2rem auto;
            text-align: center;
        }

        .pet-cards-container {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 2rem 0;
            flex-wrap: nowrap;
        }

        .pet-card {
            flex: 1;
            min-width: 200px;
            max-width: 250px;
            margin: 0;
            padding: 1.5rem;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            text-align: center;
        }

        .pet-card:hover {
            transform: translateY(-5px);
        }

        .modal .close-button {
            margin-top: 2rem;
            padding: 0.5rem 2rem;
            font-size: 1.1rem;
        }

        /* 宠物状态面板 */
        .pet-status {
            position: fixed;
            top: 5rem;
            right: 2rem;
            background: rgba(255, 248, 225, 0.9);
            padding: 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(5px);
            z-index: 100;
            width: 250px;
        }

        .pet-status.show {
            display: block;
        }

        .status-bar {
            width: 100%;
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            margin: 0.5rem 0;
            overflow: hidden;
        }

        .status-bar-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .happiness-bar { background: var(--bright-pink); }
        .hunger-bar { background: var(--light-green); }

        .pet-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .pet-action-btn {
            background: var(--dark-green);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pet-action-btn:hover {
            background: var(--bright-pink);
            transform: scale(1.05);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            pointer-events: none;
            animation: confetti-fall 3s linear forwards;
        }

        /* 修改树丛动画样式 */
        .bush-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1B5E20;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease;
        }

        .bush-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        /* 修改叶子样式 */
        .bush-leaf {
            position: absolute;
            width: 60px;
            height: 60px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,50 m-45,0 a45,45 0 1,0 90,0 a45,45 0 1,0 -90,0" fill="%234CAF50"/></svg>') no-repeat;
            background-size: contain;
            transform-origin: center;
            transition: transform 0.5s ease;
            border-radius: 50%;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        .bush-leaf.light {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,50 m-45,0 a45,45 0 1,0 90,0 a45,45 0 1,0 -90,0" fill="%2381C784"/></svg>') no-repeat;
            background-size: contain;
        }

        .bush-leaf.dark {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,50 m-45,0 a45,45 0 1,0 90,0 a45,45 0 1,0 -90,0" fill="%232E7D32"/></svg>') no-repeat;
            background-size: contain;
        }

        .bush-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 32px;
            text-align: center;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            opacity: 0;
            animation: fadeIn 1s ease forwards;
        }

        .bush-text span {
            display: block;
            margin-top: 15px;
            font-size: 20px;
            opacity: 0.8;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .bush.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* 添加留言花园样式 */
        .message-garden {
            position: relative;
            padding: 2.5rem;
            background: var(--lighter-yellow);
            border-radius: 1rem;
            margin: 2rem auto;
            max-width: 800px;
        }

        .message-form {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .message-input {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            border: 2px solid #E8F5E9;
            border-radius: 0.5rem;
            resize: vertical;
            font-size: 1rem;
            margin-bottom: 1rem;
            transition: border-color 0.3s ease;
        }

        .message-input:focus {
            outline: none;
            border-color: var(--light-green);
        }

        .send-button {
            background: var(--light-green);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 2rem;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .send-button:hover {
            background: var(--dark-green);
            transform: translateY(-2px);
        }

        .mailbox {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--lighter-yellow);
            border-radius: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .mailbox:hover {
            transform: translateY(-5px);
        }

        .mailbox-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--bright-pink);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .flower {
            position: absolute;
            width: 30px;
            height: 30px;
            animation: flowerFloat 3s ease-in-out infinite;
        }

        @keyframes flowerFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        .messages-modal {
            position: fixed;
            bottom: 80px;
            right: 2rem;
            width: 300px;
            max-height: 400px;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            display: none;
            z-index: 99;
        }

        .message-item {
            padding: 1rem;
            border-bottom: 1px solid #E8F5E9;
        }

        .message-time {
            font-size: 0.8rem;
            color: #999;
            margin-top: 0.5rem;
        }

        /* 添加秘密花园背景动画 */
        .garden-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        /* 藤蔓样式 */
        .vine {
            position: absolute;
            width: 3px;
            background: linear-gradient(to bottom, #4CAF50, #81C784);
            transform-origin: top;
            animation: vineGrow 3s ease-out forwards;
            opacity: 0.8;
            z-index: 1;
        }

        .vine::after {
            content: '🍃';
            position: absolute;
            bottom: -10px;
            left: -10px;
            font-size: 20px;
            animation: leafSway 3s ease-in-out infinite;
        }

        /* 花朵样式 */
        .garden-flower {
            position: absolute;
            font-size: 24px;
            animation: flowerBloom 2s ease-out forwards;
            opacity: 0.9;
            z-index: 2;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .garden-flower.red { content: '🌹'; }
        .garden-flower.pink { content: '🌸'; }
        .garden-flower.yellow { content: '🌼'; }
        .garden-flower.white { content: '🌺'; }

        /* 蝴蝶样式 */
        .butterfly {
            position: absolute;
            font-size: 20px;
            animation: butterflyFly 20s linear infinite;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
            z-index: 3;
        }

        /* 背景渐变 */
        .page {
            position: relative;
            background: none;
        }

        .page::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600"><defs><linearGradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:%23FFE4E8"/><stop offset="100%" style="stop-color:%23FFF0F2"/></linearGradient></defs><rect width="100%" height="100%" fill="url(%23skyGradient)"/><path d="M500,100 L550,200 L600,150 L650,200 L700,150 L750,200 L800,150 L850,200 L900,150 L950,200 L1000,150 L1000,600 L0,600 L0,150 L50,200 L100,150 L150,200 L200,150 L250,200 L300,150 L350,200 L400,150 L450,200 L500,100 Z" fill="%23F8D7DA" opacity="0.3"/><path d="M480,250 l40,-60 l40,60 l-30,-10 l0,60 l-20,0 l0,-60 Z" fill="%23FFB6C1"/><circle cx="500" cy="220" r="15" fill="%23FFB6C1"/></svg>');
            background-size: cover;
            background-position: center;
            opacity: 0.4;
            z-index: -2;
        }

        /* 添加树木装饰 */
        .page::after {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 300"><path d="M0,300 C100,200 200,250 300,200 C400,150 500,200 600,150 C700,100 800,150 900,100 C950,75 975,100 1000,50 L1000,300 L0,300 Z" fill="%238BC34A" opacity="0.2"/><path d="M50,300 C150,250 250,280 350,240 C450,200 550,250 650,200 C750,150 850,200 950,150 L1000,300 L50,300 Z" fill="%234CAF50" opacity="0.15"/></svg>');
            background-size: cover;
            background-position: bottom;
            z-index: -1;
        }

        /* 动画关键帧 */
        @keyframes vineGrow {
            from {
                height: 0;
                opacity: 0;
            }
            to {
                height: var(--vine-height);
            opacity: 1;
            }
        }

        @keyframes leafSway {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        @keyframes flowerBloom {
            0% {
                transform: scale(0) rotate(-45deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }

        @keyframes butterflyFly {
            0% {
                transform: translate(-10vw, 110vh) rotate(0deg);
            }
            25% {
                transform: translate(30vw, 50vh) rotate(-20deg);
            }
            50% {
                transform: translate(60vw, 80vh) rotate(0deg);
            }
            75% {
                transform: translate(90vw, 30vh) rotate(20deg);
            }
            100% {
                transform: translate(110vw, -10vh) rotate(0deg);
            }
        }

        /* 添加流动树叶背景 */
        .floating-leaves {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            opacity: 0.1;
        }

        .floating-leaf {
            position: absolute;
            width: 40px;
            height: 40px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50,5 Q80,40 50,95 Q20,40 50,5" fill="%234CAF50"/></svg>') no-repeat center/contain;
            animation: floatLeaf 15s linear infinite;
        }

        @keyframes floatLeaf {
            0% {
                transform: translate(-100px, -100px) rotate(0deg);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% {
                transform: translate(calc(100vw + 100px), calc(100vh + 100px)) rotate(360deg);
                opacity: 0;
            }
        }

        /* 添加动态小猫样式 */
        .active-pet {
            position: absolute;
            width: 60px;
            height: 60px;
            pointer-events: none;
            z-index: 10;
            transition: all 0.5s ease;
            image-rendering: pixelated;
        }

        .active-pet.gray {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="%23808080"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="%23808080"/><path d="M6,3 h4 v1 h-4 z" fill="%23808080"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="%23808080"/><circle cx="6" cy="8" r="1" fill="white"/><circle cx="10" cy="8" r="1" fill="white"/><path d="M7,10 h2 v1 h-2 z" fill="white"/></svg>') no-repeat center/contain;
        }

        .active-pet.orange {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="%23FFA500"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="%23FFA500"/><path d="M6,3 h4 v1 h-4 z" fill="%23FFA500"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="%23FFA500"/><circle cx="6" cy="8" r="1" fill="white"/><circle cx="10" cy="8" r="1" fill="white"/><path d="M7,10 h2 v1 h-2 z" fill="white"/></svg>') no-repeat center/contain;
        }

        .active-pet.white {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="white"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="white"/><path d="M6,3 h4 v1 h-4 z" fill="white"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="white"/><circle cx="6" cy="8" r="1" fill="%23666"/><circle cx="10" cy="8" r="1" fill="%23666"/><path d="M7,10 h2 v1 h-2 z" fill="%23666"/></svg>') no-repeat center/contain;
        }

        .active-pet.sleeping {
            animation: breathe 3s ease-in-out infinite;
        }

        .active-pet.playing {
            animation: bounce 0.5s ease-in-out infinite alternate;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes bounce {
            0% { transform: translateY(0) rotate(-5deg); }
            100% { transform: translateY(-10px) rotate(5deg); }
        }

        /* 图片展示模态框样式 */
        .image-modal {
            position: relative;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 20px;
            max-width: 60%;  /* 减小最大宽度 */
            max-height: 70vh;  /* 减小最大高度 */
            margin: 15vh auto;  /* 调整上边距 */
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .image-modal .image-container {
            margin: 15px 0;
            max-height: 50vh;  /* 减小图片容器最大高度 */
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;  /* 确保容器占满模态框宽度 */
        }

        .image-modal .image-container img {
            max-width: 100%;
            max-height: 50vh;  /* 减小图片最大高度 */
            object-fit: contain;
            border-radius: 10px;
            transition: transform 0.3s ease;
            margin: 0 auto;  /* 确保图片水平居中 */
        }

        .image-modal .image-navigation {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .image-modal .image-navigation button {
            background: var(--dark-green);
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .image-modal .image-navigation button:hover {
            background: var(--bright-pink);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* 弹幕样式 */
        .danmaku-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .danmaku {
            position: absolute;
            white-space: nowrap;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            font-size: 20px;
            animation: danmaku-move 8s linear;
            pointer-events: none;
        }

        @keyframes danmaku-move {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            to {
                transform: translateX(-100%);
                opacity: 0;
            }
        }

        /* 装饰花朵样式 */
        .modal-flower {
            position: absolute;
            font-size: 20px;  /* 减小花朵大小 */
            pointer-events: none;
            animation: flowerFloat 3s ease-in-out infinite;
        }

        /* 装饰蝴蝶样式 */
        .modal-butterfly {
            position: absolute;
            font-size: 16px;  /* 减小蝴蝶大小 */
            pointer-events: none;
            animation: butterflyFloat 4s ease-in-out infinite;
        }

        @keyframes flowerFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(10px, -10px) rotate(5deg); }
        }

        @keyframes butterflyFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(15px, -15px) rotate(15deg); }
            50% { transform: translate(0, -20px) rotate(0deg); }
            75% { transform: translate(-15px, -15px) rotate(-15deg); }
        }

        /* 弹幕输入框样式 */
        .danmaku-input-container {
            position: absolute;
            bottom: 10px;  /* 调整底部距离 */
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px;  /* 减小内边距 */
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;  /* 确保输入框在最上层 */
        }

        .danmaku-input {
            border: 2px solid var(--bright-pink);
            border-radius: 15px;
            padding: 4px 8px;  /* 减小输入框内边距 */
            width: 180px;  /* 减小输入框宽度 */
            outline: none;
        }

        .danmaku-send {
            background: var(--bright-pink);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 5px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .danmaku-send:hover {
            background: var(--dark-green);
            transform: translateY(-2px);
        }

        /* 点赞按钮样式 */
        .like-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            border: 2px solid var(--bright-pink);
            color: var(--bright-pink);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
            z-index: 2;
        }

        .like-button:hover {
            background: var(--bright-pink);
            color: white;
            transform: translateY(-2px);
        }

        .like-button.liked {
            background: var(--bright-pink);
            color: white;
        }

        .like-count {
            font-weight: bold;
        }

        /* 点赞动画效果 */
        @keyframes likeAnimation {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .like-button.liked .heart-icon {
            animation: likeAnimation 0.3s ease;
        }

        .heart-icon {
            font-size: 16px;
        }

        /* 点赞粒子效果 */
        .like-particle {
            position: absolute;
            pointer-events: none;
            animation: particleFloat 1s ease-out forwards;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) scale(0);
                opacity: 0;
            }
        }

        /* 删除AI对话窗口样式 */
        .ai-chat-container,
        .ai-chat-header,
        .ai-chat-controls,
        .ai-chat-messages,
        .chat-message,
        .message-avatar,
        .message-content,
        .ai-chat-input,
        .input-container,
        .voice-wave {
            display: none;
        }

        /* 删除语音波形动画 */
        @keyframes waveAnimation {
            0%, 100% { height: 20%; }
            50% { height: 100%; }
        }

        /* AI对话栏样式 */
        .ai-chat-bar {
            position: fixed;
            bottom: 0;
            left: 20px;  /* 从right改为left */
            width: 350px;
            background: white;
            border-radius: 15px 15px 0 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .ai-chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: var(--dark-green);
            color: white;
            border-radius: 15px 15px 0 0;
        }

        .ai-chat-header h3 {
            margin: 0;
            font-size: 16px;
        }

        .toggle-button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 16px;
        }

        .ai-chat-content {
            height: 300px;
            display: flex;
            flex-direction: column;
        }

        .ai-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            background: #f9f9f9;
        }

        .ai-message {
            display: flex;
            margin-bottom: 15px;
            align-items: flex-start;
        }

        .ai-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--dark-green);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 12px;
        }

        .ai-text {
            background: white;
            padding: 10px;
            border-radius: 15px;
            max-width: 80%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .user-message {
            flex-direction: row-reverse;
        }

        .user-avatar {
            background: var(--bright-pink);
            margin-right: 0;
            margin-left: 10px;
        }

        .user-text {
            background: var(--bright-pink);
            color: white;
        }

        .ai-input-container {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
        }

        .ai-input-container input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 20px;
            outline: none;
        }

        .ai-send-button {
            background: var(--dark-green);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            margin-left: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .ai-send-button:hover {
            background: var(--bright-pink);
        }

        .ai-chat-bar.minimized .ai-chat-content {
            display: none;
        }

        .ai-chat-bar.minimized {
            height: auto;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #aaa;
            border-radius: 50%;
            margin-right: 5px;
            animation: typing 1s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* 返回按钮样式 */
        .back-to-cover {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background-color: var(--bright-pink);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .back-to-cover:hover {
            background-color: var(--light-green);
            transform: translateY(-2px);
        }

        .back-to-cover:active {
            transform: translateY(1px);
        }

        /* 隐藏导航栏 */
        .navigation {
            display: none;
        }

        .active-pet {
            position: fixed;
            width: 60px;
            height: 60px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            cursor: pointer;
            z-index: 1000;
            transition: all 0.5s ease;
        }
        
        .active-pet.sleeping {
            animation: breathe 3s ease-in-out infinite;
        }
        
        .active-pet.playing {
            animation: bounce 0.5s ease-in-out infinite alternate;
        }
        
        .pet-interaction-options {
            position: fixed;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
        }
        
        .pet-interaction-options button {
            margin: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            background: var(--dark-green);
            color: white;
            cursor: pointer;
        }
        
        .pet-interaction-options button:hover {
            background: var(--bright-pink);
        }
        
        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes bounce {
            0% { transform: translateY(0) rotate(-5deg); }
            100% { transform: translateY(-10px) rotate(5deg); }
        }

        .pet-interaction-options {
            position: fixed;
            background: white;
            border: 2px solid var(--dark-green);
            border-radius: 10px;
            padding: 10px;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .interaction-option {
            padding: 8px 15px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .interaction-option:hover {
            background-color: var(--soft-pink);
        }
        
        .active-pet.playing {
            animation: play 2s infinite;
        }
        
        .active-pet.eating {
            animation: eat 2s infinite;
        }
        
        @keyframes play {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes eat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .celebration-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .congrats-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: bounce 1s infinite;
        }

        .firework {
            position: fixed;
            width: 5px;
            height: 5px;
            background: radial-gradient(circle, #FFD700, #FF4500);
            border-radius: 50%;
            animation: explode 1s forwards;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: fall 2s linear forwards;
        }

        @keyframes bounce {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
        }

        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(20); opacity: 0; }
        }

        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        .gesture-feedback {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 16px;
            z-index: 1000;
            display: none;
        }
        
        .gesture-feedback.show {
            display: block;
            animation: fadeInOut 2s forwards;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }

        .maze-celebration-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .celebration-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
        }

        .maze-congrats-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 1001;
        }

        .maze-congrats-title {
            font-size: 64px;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            animation: bounce 1s infinite;
        }

        .maze-congrats-subtitle {
            font-size: 24px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .maze-firework {
            position: fixed;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            animation: mazeExplode 1.5s forwards;
        }

        .maze-confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: mazeFall 3s linear forwards;
        }

        .maze-confetti.circle {
            border-radius: 50%;
        }

        .maze-confetti.triangle {
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 10px solid currentColor;
            background: none;
        }

        .maze-star {
            position: fixed;
            background: #FFD700;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            animation: mazeTwinkle 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
        }

        @keyframes mazeExplode {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(30); opacity: 0; }
        }

        @keyframes mazeFall {
            0% { transform: translateY(-100px) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(360deg); }
        }

        @keyframes mazeTwinkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }

        .maze-confetti {
            position: fixed;
            top: -20px;
            pointer-events: none;
            animation: mazeFall 5s linear forwards;
        }

        .maze-confetti.circle {
            border-radius: 50%;
        }

        .maze-confetti.square {
            border-radius: 2px;
        }

        .maze-confetti.triangle {
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 10px solid currentColor;
            background: none;
        }

        .maze-confetti.spiral {
            background: none;
            border: 2px solid;
            border-radius: 50%;
            animation: mazeFallSpiral 5s linear forwards;
        }

        .maze-confetti.glitter {
            background: radial-gradient(circle at center, currentColor 30%, transparent 70%);
            animation: mazeFallGlitter 5s linear forwards;
        }

        .maze-confetti.ribbon {
            height: 2px;
            width: 20px;
            background: linear-gradient(90deg, currentColor, transparent);
            animation: mazeFallRibbon 5s linear forwards;
        }

        @keyframes mazeFall {
            0% { 
                transform: translateY(-20px) rotate(0deg); 
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes mazeFallSpiral {
            0% { 
                transform: translateY(-20px) rotate(0deg) scale(1);
                opacity: 1;
            }
            100% { 
                transform: translateY(100vh) rotate(1080deg) scale(0.5);
                opacity: 0;
            }
        }

        @keyframes mazeFallGlitter {
            0% { 
                transform: translateY(-20px) rotate(0deg) scale(1);
                opacity: 1;
            }
            50% {
                transform: translateY(50vh) rotate(180deg) scale(1.2);
                opacity: 0.8;
            }
            100% { 
                transform: translateY(100vh) rotate(360deg) scale(0.8);
                opacity: 0;
            }
        }

        @keyframes mazeFallRibbon {
            0% { 
                transform: translateY(-20px) rotate(0deg) scaleX(1);
                opacity: 1;
            }
            50% {
                transform: translateY(50vh) rotate(180deg) scaleX(1.5);
                opacity: 0.8;
            }
            100% { 
                transform: translateY(100vh) rotate(360deg) scaleX(1);
                opacity: 0;
            }
        }

        .tag-cloud {
            position: relative;
            height: 400px;
            width: 100%;
            margin: 20px auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .tag {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
            font-size: 0.9rem;
            line-height: 1.2;
            word-break: break-word;
            animation: floatAnimation 3s infinite ease-in-out;
            transform-origin: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            color: white;
            transition: transform 0.3s ease;
        }

        .tag-text {
            margin-bottom: 5px;
            font-weight: bold;
        }

        .like-count {
            background: var(--bright-pink);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .tag:hover {
            transform: scale(1.1);
        }

        .tag:hover .like-count {
            opacity: 1;
            transform: scale(1);
        }

        @keyframes countBounce {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .heart {
            position: absolute;
            width: 24px;
            height: 24px;
            background: var(--bright-pink);
            transform: rotate(45deg);
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
        }

        .heart::before,
        .heart::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            background: var(--bright-pink);
            border-radius: 50%;
        }

        .heart::before {
            top: -12px;
            left: 0;
        }

        .heart::after {
            top: 0;
            left: -12px;
        }

        @keyframes heartFloat {
            0% {
                transform: rotate(45deg) translateY(0) scale(0.5);
                opacity: 1;
            }
            100% {
                transform: rotate(45deg) translateY(-50px) scale(1.2);
                opacity: 0;
            }
        }

        @keyframes countAnimation {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .tag:nth-child(1) { left: 10%; top: 20%; animation-delay: 0s; }
        .tag:nth-child(2) { left: 30%; top: 10%; animation-delay: 0.4s; }
        .tag:nth-child(3) { left: 50%; top: 20%; animation-delay: 0.8s; }
        .tag:nth-child(4) { left: 70%; top: 10%; animation-delay: 1.2s; }
        .tag:nth-child(5) { left: 20%; top: 60%; animation-delay: 1.6s; }
        .tag:nth-child(6) { left: 40%; top: 70%; animation-delay: 2s; }
        .tag:nth-child(7) { left: 60%; top: 60%; animation-delay: 2.4s; }
        .tag:nth-child(8) { left: 80%; top: 70%; animation-delay: 2.8s; }

        @keyframes floatAnimation {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.05); }
        }

        .photo-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            aspect-ratio: 1;
        }

        .photo-item:hover {
            transform: scale(1.02);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-item .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
            color: var(--bright-pink);
            font-size: 18px;
        }

        .photo-item:hover .delete-btn {
            opacity: 1;
        }

        .photo-item .delete-btn:hover {
            background: var(--bright-pink);
            color: white;
        }

        .photo-date {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px;
            text-align: center;
            font-size: 12px;
            color: var(--dark-green);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .photo-item:hover .photo-date {
            opacity: 1;
        }

        @keyframes floatEmoji {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(10deg);
            }
        }

        .floating-emoji {
            position: absolute;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .photo-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        /* 添加到已有的样式中 */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #generateDogBtn:hover {
            transform: scale(1.05);
            background-color: var(--dark-green);
        }

        .dog-image-container {
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <!-- 封面页面 -->
    <div class="cover-page" id="coverPage">
        <div class="cover-text">
            <div class="chinese-text">你眼中的我？</div>
            <div class="english-text">Which one do you want to know about me</div>
        </div>
        <div class="click-area camera-area" onclick="navigateTo('home')">
            <img src="public/相机.jpg" alt="照相机">
            <span>首页</span>
        </div>
        <div class="click-area cat-area" onclick="navigateTo('fun')">
            <img src="public/小猫.jpg" alt="小猫">
            <span>有趣的事</span>
        </div>
        <div class="click-area notebook-area" onclick="navigateTo('contact')">
            <img src="public/本子.jpg" alt="本子">
            <span>联系我</span>
        </div>
        <div class="click-area palette-area" onclick="navigateTo('about')">
            <img src="public/画笔.jpg" alt="调色盘">
            <span>关于我</span>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div class="main-content" id="mainContent">
        <button class="back-to-cover" onclick="backToCover()">返回封面</button>
        <div class="page" id="home">
            <div class="floating-leaves" id="floatingLeaves"></div>
            <div class="container">
                <section class="welcome-section">
                    <h1 class="welcome-title">Life is like<br>a box<br>collecting happiness</h1>
                    <div class="category-text">
                        <span>生活</span>
                        <span>自我</span>
                        <span>旅行</span>
                    </div>
                </section>
                
                <div class="life-gallery">
                    <!-- 生活照片 -->
                    <div class="gallery-item">
                        <img src="public/day.jpg" alt="日常生活">
                        <div class="gallery-category">生活</div>
                        <div class="gallery-overlay">
                            <h3 class="gallery-title">温馨日常</h3>
                            <p class="gallery-description">记录生活中的美好时刻</p>
                        </div>
                    </div>
                    
                    <!-- 自我展示 -->
                    <div class="gallery-item">
                        <img src="public/xiezhen.jpg" alt="个人写真">
                        <div class="gallery-category">自我</div>
                        <div class="gallery-overlay">
                            <h3 class="gallery-title">个人写真</h3>
                            <p class="gallery-description">展现最真实的自己</p>
                        </div>
                    </div>
                    
                    <!-- 旅行照片 -->
                    <div class="gallery-item">
                        <img src="public/travel.jpg" alt="旅行">
                        <div class="gallery-category">旅行</div>
                        <div class="gallery-overlay">
                            <h3 class="gallery-title">旅行足迹</h3>
                            <p class="gallery-description">探索世界的每一个角落</p>
                        </div>
                    </div>
                    
                    <!-- 更多生活照片 -->
                    <div class="gallery-item">
                        <img src="public/food.jpg" alt="美食">
                        <div class="gallery-category">美食</div>
                        <div class="gallery-overlay">
                            <h3 class="gallery-title">美食记录</h3>
                            <p class="gallery-description">品味生活中的美味</p>
                        </div>
                    </div>
                    
                    <!-- 更多自我展示 -->
                    <div class="gallery-item">
                        <img src="public/like.jpg" alt="兴趣爱好">
                        <div class="gallery-category">兴趣</div>
                        <div class="gallery-overlay">
                            <h3 class="gallery-title">兴趣爱好</h3>
                            <p class="gallery-description">分享我的快乐源泉</p>
                        </div>
                    </div>
                    
                    <!-- 更多旅行照片 -->
                    <div class="gallery-item">
                        <img src="public/fengjing.jpg" alt="风景">
                        <div class="gallery-category">风景</div>
                        <div class="gallery-overlay">
                            <h3 class="gallery-title">风景掠影</h3>
                            <p class="gallery-description">定格美丽的瞬间</p>
                        </div>
                    </div>
                </div>

                <div class="memory-section" style="margin-top: 40px; text-align: center; padding: 30px; background: rgba(255, 255, 255, 0.9); border-radius: 15px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                    <h2 class="text-dark-green" style="margin-bottom: 20px;">留下你的专属记忆</h2>
                    
                    <div class="camera-options" style="display: flex; justify-content: center; gap: 30px; margin-bottom: 20px;">
                        <div class="camera-container" style="position: relative; display: inline-block; cursor: pointer;" onclick="handlePhotoUpload()">
                            <div class="camera-icon" style="font-size: 48px; color: var(--dark-green); animation: float 2s infinite ease-in-out;">📸</div>
                            <div class="camera-text" style="margin-top: 15px; color: var(--dark-green); font-size: 1.1rem;">上传照片</div>
                            <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="handlePhotoChange(event)">
                        </div>

                        <div class="camera-container" style="position: relative; display: inline-block; cursor: pointer;" onclick="startCamera()">
                            <div class="camera-icon" style="font-size: 48px; color: var(--dark-green); animation: float 2s infinite ease-in-out;">🎥</div>
                            <div class="camera-text" style="margin-top: 15px; color: var(--dark-green); font-size: 1.1rem;">打开相机</div>
                        </div>
                    </div>

                    <!-- 相机预览和照片预览区域 -->
                    <div id="previewSection" style="display: none; margin-top: 20px;">
                        <video id="cameraPreview" autoplay playsinline style="display: none; max-width: 100%; height: 300px; border-radius: 10px;"></video>
                        <img id="photoPreview" style="display: none; max-width: 100%; height: 300px; object-fit: contain; border-radius: 10px;">
                        
                        <div class="preview-controls" style="margin-top: 15px;">
                            <button id="captureBtn" onclick="capturePhoto()" style="display: none; background: var(--dark-green); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; margin: 0 10px;">拍照</button>
                            <button id="retakeBtn" onclick="retakePhoto()" style="display: none; background: var(--bright-pink); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; margin: 0 10px;">重拍</button>
                            <button id="saveBtn" onclick="savePhoto()" style="display: none; background: var(--dark-green); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; margin: 0 10px;">保存照片</button>
                        </div>
                    </div>

                    <!-- 保存的照片展示区域 -->
                    <div class="saved-photos" style="margin-top: 30px;">
                        <h3 class="text-dark-green" style="margin-bottom: 15px; display: none;" id="savedPhotosTitle">我的照片墙</h3>
                        <div id="photoWall" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                            <!-- 照片将在这里动态添加 -->
                        </div>
                    </div>
                </div>

                <style>
                    @keyframes float {
                        0%, 100% { transform: translateY(0); }
                        50% { transform: translateY(-10px); }
                    }
                    
                    .camera-container:hover .camera-icon {
                        transform: scale(1.1);
                    }
                    
                    .camera-container:hover .camera-text {
                        color: var(--bright-pink) !important;
                    }
                    
                    .camera-icon {
                        transition: transform 0.3s ease;
                    }
                    
                    .camera-text {
                        transition: color 0.3s ease;
                    }

                    .preview-controls button:hover {
                        opacity: 0.9;
                        transform: scale(1.05);
                    }

                    .preview-controls button {
                        transition: all 0.3s ease;
                    }
                </style>

                <script>
                    // 将stream变量声明移动到全局作用域
                    window.cameraStream = null;
                    
                    function handlePhotoUpload() {
                        document.getElementById('photoInput').click();
                    }

                    function handlePhotoChange(event) {
                        const file = event.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                const previewSection = document.getElementById('previewSection');
                                const photoPreview = document.getElementById('photoPreview');
                                const saveBtn = document.getElementById('saveBtn');
                                
                                photoPreview.src = e.target.result;
                                photoPreview.style.display = 'block';
                                previewSection.style.display = 'block';
                                saveBtn.style.display = 'inline-block';
                                
                                // 隐藏相机预览
                                document.getElementById('cameraPreview').style.display = 'none';
                                document.getElementById('captureBtn').style.display = 'none';
                            }
                            reader.readAsDataURL(file);
                        }
                    }

                    async function startCamera() {
                        try {
                            if (window.cameraStream) {
                                window.cameraStream.getTracks().forEach(track => track.stop());
                            }
                            window.cameraStream = await navigator.mediaDevices.getUserMedia({ video: true });
                            const previewSection = document.getElementById('previewSection');
                            const cameraPreview = document.getElementById('cameraPreview');
                            const captureBtn = document.getElementById('captureBtn');
                            
                            cameraPreview.srcObject = window.cameraStream;
                            previewSection.style.display = 'block';
                            cameraPreview.style.display = 'block';
                            captureBtn.style.display = 'inline-block';
                            
                            // 隐藏照片预览
                            document.getElementById('photoPreview').style.display = 'none';
                            document.getElementById('saveBtn').style.display = 'none';
                        } catch (err) {
                            alert('无法访问摄像头：' + err.message);
                        }
                    }

                    function capturePhoto() {
                        const cameraPreview = document.getElementById('cameraPreview');
                        const photoPreview = document.getElementById('photoPreview');
                        const canvas = document.createElement('canvas');
                        
                        canvas.width = cameraPreview.videoWidth;
                        canvas.height = cameraPreview.videoHeight;
                        canvas.getContext('2d').drawImage(cameraPreview, 0, 0);
                        
                        photoPreview.src = canvas.toDataURL('image/jpeg');
                        photoPreview.style.display = 'block';
                        cameraPreview.style.display = 'none';
                        
                        // 显示重拍和保存按钮
                        document.getElementById('captureBtn').style.display = 'none';
                        document.getElementById('retakeBtn').style.display = 'inline-block';
                        document.getElementById('saveBtn').style.display = 'inline-block';
                    }

                    function retakePhoto() {
                        const cameraPreview = document.getElementById('cameraPreview');
                        const photoPreview = document.getElementById('photoPreview');
                        
                        cameraPreview.style.display = 'block';
                        photoPreview.style.display = 'none';
                        
                        // 显示拍照按钮，隐藏重拍和保存按钮
                        document.getElementById('captureBtn').style.display = 'inline-block';
                        document.getElementById('retakeBtn').style.display = 'none';
                        document.getElementById('saveBtn').style.display = 'none';
                    }

                    function savePhoto() {
                        const photoPreview = document.getElementById('photoPreview');
                        const photoWall = document.getElementById('photoWall');
                        const savedPhotosTitle = document.getElementById('savedPhotosTitle');
                        
                        // 分析照片中的表情
                        analyzePhoto(photoPreview.src)
                            .then(emotions => {
                                const emojis = getEmotionEmojis(emotions);
                                
                                // 创建新的照片元素
                                const photoItem = document.createElement('div');
                                photoItem.className = 'photo-item';
                                
                                // 生成唯一ID
                                const photoId = 'photo_' + Date.now();
                                photoItem.id = photoId;
                                
                                // 获取当前日期时间
                                const now = new Date();
                                const dateStr = now.toLocaleDateString('zh-CN') + ' ' + 
                                             now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
                                
                                // 设置照片HTML
                                photoItem.innerHTML = `
                                    <div class="photo-container" style="position: relative; width: 100%; height: 100%;">
                                        <img src="${photoPreview.src}" alt="保存的照片">
                                        <button class="delete-btn" onclick="deletePhoto('${photoId}')">×</button>
                                        <div class="photo-date">${dateStr}</div>
                                    </div>
                                `;
                                
                                // 添加表情装饰
                                const photoContainer = photoItem.querySelector('.photo-container');
                                createFloatingEmojis(photoContainer, emojis);
                                
                                // 添加到照片墙
                                photoWall.insertBefore(photoItem, photoWall.firstChild);
                                savedPhotosTitle.style.display = 'block';
                                
                                // 保存到本地存储
                                saveToLocalStorage(photoId, {
                                    src: photoPreview.src,
                                    date: dateStr,
                                    emojis: emojis
                                });
                                
                                // 关闭相机并重置界面
                                if (window.cameraStream) {
                                    window.cameraStream.getTracks().forEach(track => track.stop());
                                    window.cameraStream = null;
                                }
                                
                                document.getElementById('previewSection').style.display = 'none';
                                document.getElementById('retakeBtn').style.display = 'none';
                                document.getElementById('saveBtn').style.display = 'none';
                                
                                // 显示保存成功提示
                                alert('照片保存成功！');
                            })
                            .catch(error => {
                                console.error('表情识别失败:', error);
                                alert('照片保存成功！（表情识别失败）');
                            });
                    }

                    // 修改加载保存的照片的函数
                    window.addEventListener('load', function() {
                        const savedPhotos = JSON.parse(localStorage.getItem('savedPhotos') || '{}');
                        const photoWall = document.getElementById('photoWall');
                        const savedPhotosTitle = document.getElementById('savedPhotosTitle');
                        
                        if (Object.keys(savedPhotos).length > 0) {
                            savedPhotosTitle.style.display = 'block';
                            
                            Object.entries(savedPhotos).forEach(([id, data]) => {
                                const photoItem = document.createElement('div');
                                photoItem.className = 'photo-item';
                                photoItem.id = id;
                                
                                photoItem.innerHTML = `
                                    <div class="photo-container" style="position: relative; width: 100%; height: 100%;">
                                        <img src="${data.src}" alt="保存的照片">
                                        <button class="delete-btn" onclick="deletePhoto('${id}')">×</button>
                                        <div class="photo-date">${data.date}</div>
                                    </div>
                                `;
                                
                                // 如果有表情数据，添加表情装饰
                                if (data.emojis) {
                                    const photoContainer = photoItem.querySelector('.photo-container');
                                    createFloatingEmojis(photoContainer, data.emojis);
                                }
                                
                                photoWall.appendChild(photoItem);
                            });
                        }
                    });

                    function deletePhoto(photoId) {
                        if (confirm('确定要删除这张照片吗？')) {
                            const photoElement = document.getElementById(photoId);
                            if (photoElement) {
                                photoElement.remove();
                                removeFromLocalStorage(photoId);
                                
                                // 如果没有照片了，隐藏标题
                                const photoWall = document.getElementById('photoWall');
                                if (!photoWall.children.length) {
                                    document.getElementById('savedPhotosTitle').style.display = 'none';
                                }
                            }
                        }
                    }

                    function saveToLocalStorage(id, photoData) {
                        const savedPhotos = JSON.parse(localStorage.getItem('savedPhotos') || '{}');
                        savedPhotos[id] = photoData;
                        localStorage.setItem('savedPhotos', JSON.stringify(savedPhotos));
                    }

                    function removeFromLocalStorage(id) {
                        const savedPhotos = JSON.parse(localStorage.getItem('savedPhotos') || '{}');
                        delete savedPhotos[id];
                        localStorage.setItem('savedPhotos', JSON.stringify(savedPhotos));
                    }
                </script>
            </div>
        </div>

        <!-- 关于页面 -->
        <div id="about" class="page">
            <div class="garden-background" id="aboutGarden"></div>
            <div class="container">
                <div class="bg-lighter-yellow">
                    <h2 class="text-dark-green">关于我</h2>
                    <p class="text-dark-green" style="line-height: 1.6;">
                        Hello！你好啊！我是李诗淼，是一名来自内蒙古包头市的大学生，现就读于<a href="https://www.bjtu.edu.cn" target="_blank" class="school-link">北京交通大学</a>建筑与艺术学院视觉传达设计专业。我性格开朗，热爱生活，喜欢自言自语，也喜欢和朋友和朋友玩抽象，本人对东玄西玄十分感兴趣，可以一起交流讨论哦！
                    </p>
                    <p class="text-dark-green" style="margin-top: 1rem;">
                        欢迎你来到我的小花园！期待你的浏览与留言~
                    </p>
                </div>

                <div class="grid">
                    <div id="personalityCard" class="bg-lighter-yellow hover-glow cursor-pointer">
                        <h2 class="text-bright-pink" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            处女座INFJ
                            <span id="toggleText" style="font-size: 0.875rem;">点击展开</span>
                        </h2>
                        <ul class="text-dark-green" style="list-style: none;">
                            <li class="hover-glow" style="padding: 0.5rem; transition: all 0.3s ease;">喜欢自驾游</li>
                            <li class="hover-glow" style="padding: 0.5rem; transition: all 0.3s ease;">喜欢猫猫狗狗</li>
                            <li class="hover-glow" style="padding: 0.5rem; transition: all 0.3s ease;">小马宝莉和狐妖小红娘</li>
                            <li class="hover-glow" style="padding: 0.5rem; transition: all 0.3s ease;">地狱少女十年粉丝</li>
                        </ul>
                    </div>

                    <div id="socialCard" class="bg-lighter-yellow social-card">
                        <h2 class="text-dark-green" style="margin-bottom: 1rem;">我的社交</h2>
                        <ul class="text-bright-pink" style="list-style: none;">
                            <li class="social-link cursor-pointer" onclick="window.open('https://www.douyin.com/user/self?from_tab_name=main&showTab=post', '_blank')">抖音</li>
                            <li class="social-link cursor-pointer" onclick="window.open('https://www.xiaohongshu.com/user/profile/63fd4a2d0000000010025348', '_blank')">小红书</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-lighter-yellow" style="margin-top: 2rem;">
                    <h2 class="text-dark-green floating">我的作品</h2>
                    <div class="works-grid" id="workGrid">
                        <!-- 作品一 -->
                        <div class="image-container hover-glow" data-work="1">
                            <img src="public/work1.jpg" alt="实物部分展示">
                            <div class="image-overlay">
                                <span>实物部分展示</span>
                            </div>
                        </div>
                        <!-- 作品二 -->
                        <div class="image-container hover-glow" data-work="2">
                            <img src="public/work2.jpg" alt="课程部分作品">
                            <div class="image-overlay">
                                <span>课程部分作品</span>
                            </div>
                        </div>
                        <!-- 作品三 -->
                        <div class="image-container hover-glow" data-work="3">
                            <img src="public/work3.jpg" alt="随便画画">
                            <div class="image-overlay">
                                <span>随便画画</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 有趣的事页面 -->
        <div id="fun" class="page">
            <div class="garden-background" id="funGarden"></div>
            <div class="container">
                <p class="game-intro" style="font-size: 1.2rem; color: var(--dark-green); margin-bottom: 1.5rem; text-align: center;">
                    这里是喜欢猫猫狗狗的游戏乐园，快下拉页面试试吧！
                </p>
                <div class="maze-container">
                    <h2 class="text-dark-green">迷宫游戏</h2>
                    <p id="mazeInfo" class="text-dark-green">使用方向键控制小猫移动！</p>
                    <div id="maze"></div>
                    <div class="maze-controls">
                        <button class="maze-container .adopt-button" onclick="generateMaze()">生成新迷宫</button>
                    </div>
                </div>

                <div class="pet-garden">
                    <h2 class="text-dark-green">领养小猫</h2>
                    <p class="text-dark-green">选择一只可爱的小猫作为你的伙伴！</p>
                    <button class="adopt-button" onclick="handleAdoptionClick()">开始领养</button>
                </div>

                <!-- 随机小狗图片生成器 -->
                <div class="dog-generator-section" style="margin-top: 2rem; padding: 2rem; background-color: var(--light-pink); border-radius: 15px; text-align: center;">
                    <h2 class="text-dark-green" style="font-family: 'AaBaiYunCangGouYeMaChenAi', sans-serif;">说说你心里的小狗</h2>
                    <div class="dog-image-container" style="max-width: 500px; margin: 0 auto; position: relative;">
                        <img id="randomDogImage" src="" alt="随机小狗图片" style="width: 100%; border-radius: 10px; display: none;">
                        <div class="loading-spinner" style="display: none;">
                            <div style="width: 40px; height: 40px; border: 4px solid var(--bright-pink); border-top-color: transparent; border-radius: 50%; margin: 0 auto; animation: spin 1s linear infinite;"></div>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button id="generateDogBtn" style="padding: 0.8rem 1.5rem; background-color: var(--bright-pink); color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 1.1rem; transition: all 0.3s ease;">
                            生成新的小狗图片
                        </button>
                        <button id="voiceControlBtn" style="margin-left: 1rem; padding: 0.8rem 1.5rem; background-color: var(--dark-green); color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 1.1rem; transition: all 0.3s ease;">
                            语音描述生成
                        </button>
                    </div>
                    <div id="voiceStatus" style="margin-top: 1rem; color: var(--dark-green); font-size: 0.9rem;"></div>
                </div>
            </div>
        </div>

        <!-- 联系我页面 -->
        <div id="contact" class="page">
            <div class="garden-background" id="contactGarden"></div>
            <div class="container">
                <div class="message-garden">
                    <h2 class="text-dark-green">留言花园</h2>
                    <p class="text-dark-green">在这里留下你的心情与想法，让美好的文字在花园中绽放~</p>
                    
                    <div class="message-form">
                        <textarea class="message-input" placeholder="写下你想说的话..." maxlength="500"></textarea>
                        <button class="send-button" onclick="sendMessage()">
                            发送留言
                            <span>✉️</span>
                        </button>
                    </div>

                    <div class="messages-container" id="messagesContainer">
                        <!-- Messages will be displayed here -->
                    </div>

                    <div class="personality-section" style="margin-top: 40px;">
                        <h3 class="text-dark-green" style="text-align: center; margin-bottom: 20px;">给我贴上标签吧~</h3>
                        <div class="tag-cloud">
                            <div class="tag" style="background: #FF69B4;">
                                <span class="tag-text">热爱生活</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #87CEEB;">
                                <span class="tag-text">创意无限</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #98FB98;">
                                <span class="tag-text">积极向上</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #DDA0DD;">
                                <span class="tag-text">温暖治愈</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #F0E68C;">
                                <span class="tag-text">充满活力</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #FFA07A;">
                                <span class="tag-text">乐观开朗</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #B0C4DE;">
                                <span class="tag-text">善良友好</span>
                                <span class="like-count">0</span>
                            </div>
                            <div class="tag" style="background: #FFB6C1;">
                                <span class="tag-text">勇于尝试</span>
                                <span class="like-count">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 添加邮箱图标和消息列表 -->
        <div class="mailbox" onclick="toggleMessages()" style="position: fixed; bottom: 20px; right: 20px; background: var(--dark-green); color: white; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <span>📮</span>
            <div class="mailbox-count" style="position: absolute; top: -5px; right: -5px; background: var(--bright-pink); color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; display: flex; align-items: center; justify-content: center;">0</div>
        </div>

        <div id="messages-modal" class="messages-modal" style="display: none; position: fixed; bottom: 80px; right: 20px; width: 300px; max-height: 400px; overflow-y: auto; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 15px; z-index: 1000;">
            <!-- Messages will be displayed here -->
        </div>

        <!-- 领养模态框 -->
        <div id="adoptionOverlay" class="modal-overlay">
            <div id="adoptionModal" class="modal">
                <h2 class="text-dark-green">选择你的小伙伴</h2>
                <div class="pet-cards-container">
                    <div class="pet-card">
                        <div class="pet-image" style="background-image: url('public/小灰.png')"></div>
                        <h3 class="pet-name">灰灰</h3>
                        <p>一只安静的灰色小猫</p>
                        <button class="adopt-button" onclick="adoptPet('灰灰')">领养我</button>
                    </div>
                    <div class="pet-card">
                        <div class="pet-image" style="background-image: url('public/雪球.png')"></div>
                        <h3 class="pet-name">雪球</h3>
                        <p>活泼可爱的橘猫</p>
                        <button class="adopt-button" onclick="adoptPet('雪球')">领养我</button>
                    </div>
                    <div class="pet-card">
                        <div class="pet-image" style="background-image: url('public/大菊.png')"></div>
                        <h3 class="pet-name">大橘</h3>
                        <p>温顺乖巧的橘猫</p>
                        <button class="adopt-button" onclick="adoptPet('大橘')">领养我</button>
                    </div>
                </div>
                <button class="adopt-button close-button" onclick="closeAdoptionModal()">关闭</button>
            </div>
        </div>

        <!-- 宠物状态面板 -->
        <div class="pet-status" id="petStatus">
            <div class="adopted-pet" id="adoptedPetImage"></div>
            <div class="pet-mood" id="petMood">😊</div>
            <h3 class="text-dark-green" id="petName"></h3>
            <div>
                <p class="text-dark-green">愉悦值：<span id="happinessValue">100</span>%</p>
                <div class="status-bar">
                    <div class="status-bar-fill happiness-bar" id="happinessBar" style="width: 100%"></div>
                </div>
            </div>
            <div>
                <p class="text-dark-green">饥饿度：<span id="hungerValue">100</span>%</p>
                <div class="status-bar">
                    <div class="status-bar-fill hunger-bar" id="hungerBar" style="width: 100%"></div>
                </div>
            </div>
            <div class="pet-actions">
                <button class="pet-action-btn" onclick="playWithPet()">陪玩</button>
                <button class="pet-action-btn" onclick="feedPet()">喂食</button>
            </div>
        </div>

        <!-- 图片展示模态框 -->
        <div id="imageModal" class="modal-overlay">
            <div class="image-modal">
                <span class="close-button" onclick="closeImageModal()">&times;</span>
                <div class="image-container">
                    <img id="modalImage" src="" alt="展示图片">
                </div>
                <div class="image-navigation">
                    <button onclick="prevImage()">上一张</button>
                    <button onclick="nextImage()">下一张</button>
                </div>
                <button class="like-button" onclick="handleLike()">
                    <span class="heart-icon">❤️</span>
                    <span class="like-count">0</span>
                </button>
            </div>
        </div>

        <!-- 删除AI对话窗口HTML结构 -->
        <div id="aiChat" style="display: none;"></div>

        <!-- 删除聊天页面 -->
        <div id="chat" style="display: none;"></div>

        <!-- AI对话栏 -->
        <div class="ai-chat-bar">
            <div class="ai-chat-header">
                <h3>和李诗淼聊天</h3>
                <button onclick="toggleAIChatBar()" class="toggle-button">➖</button>
            </div>
            <div class="ai-chat-content" id="aiChatContent">
                <div class="ai-messages" id="aiMessages">
                    <div class="ai-message">
                        <div class="ai-avatar">李诗淼</div>
                        <div class="ai-text">你好！我是李诗淼，有什么想和我聊的吗？</div>
                    </div>
                </div>
                <div class="ai-input-container">
                    <input type="text" id="aiInput" placeholder="输入消息..." onkeypress="handleAIKeyPress(event)">
                    <button onclick="sendAIMessage()" class="ai-send-button">发送</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 返回封面函数
        function backToCover() {
            const coverPage = document.getElementById('coverPage');
            const mainContent = document.getElementById('mainContent');
            
            // 显示封面
            coverPage.style.display = 'flex';
            coverPage.style.opacity = '1';
            
            // 隐藏主内容
            mainContent.style.display = 'none';
            
            // 重新随机分布图片
            randomizePositions();
        }

        // 页面导航函数
        function navigateTo(page) {
            const coverPage = document.getElementById('coverPage');
            const mainContent = document.getElementById('mainContent');
            
            // 淡出封面
            coverPage.style.opacity = '0';
            
            // 显示主内容并跳转到对应页面
            setTimeout(() => {
                coverPage.style.display = 'none';
                mainContent.style.display = 'block';
                showPage(page);
            }, 1000);
        }

        // 随机分布图片
        function randomizePositions() {
            const areas = ['camera-area', 'cat-area', 'notebook-area', 'palette-area'];
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            // 定义安全区域（中间文字区域）
            const safeZone = {
                x: (windowWidth - 400) / 2,
                y: (windowHeight - 200) / 2,
                width: 400,
                height: 200
            };
            
            // 存储已放置图片的位置
            const placedImages = [];
            
            areas.forEach(area => {
                const element = document.querySelector(`.${area}`);
                if (element) {
                    let randomX, randomY;
                    let attempts = 0;
                    const maxAttempts = 100;
                    let positionFound = false;
                    
                    do {
                        // 计算随机位置，确保图片不会超出屏幕
                        const maxX = windowWidth - 350;
                        const maxY = windowHeight - 350;
                        
                        randomX = Math.floor(Math.random() * maxX);
                        randomY = Math.floor(Math.random() * maxY);
                        
                        attempts++;
                        
                        // 检查是否与安全区域重叠
                        const overlapsSafeZone = 
                            randomX + 350 > safeZone.x && 
                            randomX < safeZone.x + safeZone.width &&
                            randomY + 350 > safeZone.y && 
                            randomY < safeZone.y + safeZone.height;
                        
                        // 检查是否与其他已放置的图片重叠
                        const overlapsOtherImages = placedImages.some(placed => {
                            return (
                                randomX + 350 > placed.x &&
                                randomX < placed.x + 350 &&
                                randomY + 350 > placed.y &&
                                randomY < placed.y + 350
                            );
                        });
                        
                        // 如果位置合适，标记为找到位置
                        if (!overlapsSafeZone && !overlapsOtherImages) {
                            positionFound = true;
                        }
                        
                        // 如果尝试次数过多，强制放置在最边缘
                        if (attempts >= maxAttempts && !positionFound) {
                            // 尝试四个角落
                            const corners = [
                                { x: 0, y: 0 }, // 左上
                                { x: maxX, y: 0 }, // 右上
                                { x: 0, y: maxY }, // 左下
                                { x: maxX, y: maxY } // 右下
                            ];
                            
                            // 检查每个角落是否可用
                            for (const corner of corners) {
                                const cornerOverlaps = placedImages.some(placed => {
                                    return (
                                        corner.x + 350 > placed.x &&
                                        corner.x < placed.x + 350 &&
                                        corner.y + 350 > placed.y &&
                                        corner.y < placed.y + 350
                                    );
                                });
                                
                                if (!cornerOverlaps) {
                                    randomX = corner.x;
                                    randomY = corner.y;
                                    positionFound = true;
                                    break;
                                }
                            }
                            
                            // 如果所有角落都被占用，强制放置在最边缘
                            if (!positionFound) {
                                randomX = Math.random() > 0.5 ? 0 : maxX;
                                randomY = Math.random() > 0.5 ? 0 : maxY;
                            }
                        }
                    } while (!positionFound && attempts < maxAttempts);
                    
                    // 记录已放置图片的位置
                    placedImages.push({ x: randomX, y: randomY });
                    
                    element.style.left = `${randomX}px`;
                    element.style.top = `${randomY}px`;
                    element.style.right = 'auto';
                    element.style.bottom = 'auto';
                }
            });
        }

        // 页面加载时随机分布图片
        window.addEventListener('load', randomizePositions);
        
        // 窗口大小改变时重新随机分布
        window.addEventListener('resize', randomizePositions);

        // 全局变量
        let maze = [];
        let path = [];
        let catPosition = [1, 1];
        const mazeSize = 11;
        let isMoving = false;
        let moveTimeout = null;
        let adoptedPet = null;
        let petInterval = null;
        let showSocial = false;
        let activeWork = null;

        // 添加树丛动画相关变量
        let isBushHidden = false;
        let mouseX = 0;
        let mouseY = 0;
        let bushX = 0;
        let bushY = 0;

        // 添加留言花园相关变量
        let messages = JSON.parse(localStorage.getItem('gardenMessages') || '[]');

        // 初始化消息数组
        let mailboxMessages = JSON.parse(localStorage.getItem('mailboxMessages')) || [];

        // DOM加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            initializePersonalityCard();
            initializeWorks();
            initializeNavigation();
            generateMaze();
            
            // 添加键盘控制
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeAdoptionModal();
                } else if (e.key.startsWith('Arrow')) {
                    switch(e.key) {
                        case 'ArrowUp': moveCat('up'); break;
                        case 'ArrowDown': moveCat('down'); break;
                        case 'ArrowLeft': moveCat('left'); break;
                        case 'ArrowRight': moveCat('right'); break;
                    }
                }
            });
            
            // 恢复宠物状态
            try {
                const savedPet = localStorage.getItem('adoptedPet');
                if (savedPet) {
                    adoptedPet = JSON.parse(savedPet);
                    updatePetStatus();
                    startPetMonitoring();
                }
            } catch (error) {
                console.error('恢复宠物状态失败:', error);
            }

            // 初始化树丛动画
            initializeBushAnimation();

            // 添加留言花园相关函数
            updateMailboxCount();
            createFlowers();

            // 添加秘密花园背景动画
            initializeGardenBackground();

            // 添加流动树叶背景初始化
            initializeFloatingLeaves();

            // 添加动态小猫行为
            createActivePet();

            // 初始化语音识别
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = true;
                recognition.lang = 'zh-CN';

                recognition.onresult = function(event) {
                    const result = event.results[0][0].transcript;
                    document.getElementById('chatInput').value = result;
                };

                recognition.onend = function() {
                    isVoiceInputActive = false;
                    document.getElementById('voiceWave').classList.remove('active');
                };
            }

            // 修改发送消息函数
            async function sendMessage() {
                const input = document.getElementById('chatInput');
                const message = input.value.trim();
                
                if (message) {
                    // 显示用户消息
                    addMessage(message, true);
                    input.value = '';
                    
                    // 显示正在输入状态
                    const typingDiv = document.createElement('div');
                    typingDiv.className = 'chat-message';
                    typingDiv.innerHTML = `
                        <div class="message-avatar ai">黛玉</div>
                        <div class="message-content typing">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    `;
                    document.getElementById('chatMessages').appendChild(typingDiv);
                    
                    // 调用Deepseek API获取回复
                    const response = await sendToDeepseek(message);
                    
                    // 移除输入状态显示
                    typingDiv.remove();
                    
                    // 显示AI回复
                    addMessage(response, false);
                }
            }

            // 修改初始欢迎语
            document.querySelector('#chatMessages .message-content').textContent = 
                '妾身见过各位。今日春光正好，能与诸位相谈，也是一段佳缘呢。不知有何见教？';

            // 修改AI头像显示
            document.querySelectorAll('.message-avatar.ai').forEach(avatar => {
                avatar.textContent = '黛玉';
                avatar.style.fontFamily = '"楷体", KaiTi, serif';
            });

            // 添加输入框提示语
            document.querySelector('#chatInput').placeholder = '有何话要与妾身说呢...';

            // 修改发送按钮样式
            const sendButton = document.querySelector('.input-container button[title="发送"]');
            sendButton.innerHTML = '奉上';
            sendButton.style.fontFamily = '"楷体", KaiTi, serif';

            // 绑定领养按钮点击事件
            const startAdoptionButton = document.getElementById('startAdoption');
            if (startAdoptionButton) {
                startAdoptionButton.addEventListener('click', function() {
                    showAdoptionModal();
                });
            }
        });

        // 页面切换功能
        function showPage(pageId) {
            console.log('切换页面到:', pageId);
            // 隐藏所有页面
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });

            // 显示选中的页面
            const selectedPage = document.getElementById(pageId);
            if (selectedPage) {
                selectedPage.classList.add('active');
            }

            // 确保只有一个小猫
            const existingPets = document.querySelectorAll('#activePet');
            if (existingPets.length > 1) {
                // 如果存在多个小猫，只保留第一个，移除其他的
                for (let i = 1; i < existingPets.length; i++) {
                    existingPets[i].remove();
                }
            }

            // 确保小猫在页面切换后仍然存在
            const pet = document.getElementById('activePet');
            if (!pet && adoptedPet) {
                createActivePet();
            } else if (pet) {
                // 如果小猫存在，将其移动到新页面的合适位置
                const container = selectedPage.querySelector('.container');
                if (container) {
                    const rect = container.getBoundingClientRect();
                    const newX = rect.left + (rect.width / 2);
                    const newY = rect.top + (rect.height / 2);
                    pet.style.left = newX + 'px';
                    pet.style.top = newY + 'px';
                }
            }
        }

        // 初始化个性卡片
        function initializePersonalityCard() {
            const personalityCard = document.getElementById('personalityCard');
            const socialCard = document.getElementById('socialCard');
            const toggleText = document.getElementById('toggleText');

            personalityCard.addEventListener('click', () => {
                showSocial = !showSocial;
                toggleText.textContent = showSocial ? "点击收起" : "点击展开";
                socialCard.classList.toggle('active', showSocial);
            });

            const items = personalityCard.querySelectorAll('li');
            items.forEach(item => {
                item.addEventListener('mouseenter', () => {
                    item.style.transform = 'translateX(10px)';
                });
                item.addEventListener('mouseleave', () => {
                    item.style.transform = 'translateX(0)';
                });
            });
        }

        // 初始化作品展示
        function initializeWorks() {
            const workGrid = document.getElementById('workGrid');
            const works = [
                { id: 1, title: '作品一', image: './public/work1.jpg' },
                { id: 2, title: '作品二', image: './public/work2.jpg' },
                { id: 3, title: '作品三', image: './public/work3.jpg' }
            ];

            works.forEach(work => {
                const workCard = createWorkCard(work);
                workGrid.appendChild(workCard);
            });
        }

        // 创建作品卡片
        function createWorkCard(work) {
            const div = document.createElement('div');
            div.className = 'image-container hover-glow';
            div.innerHTML = `
                <img src="${work.image}" alt="${work.title}">
                <div class="image-overlay">
                    <span>${work.title}</span>
                </div>
            `;

            div.addEventListener('click', () => handleWorkClick(work.id, div));
            return div;
        }

        // 处理作品点击
        function handleWorkClick(id, element) {
            if (activeWork === id) {
                element.classList.remove('active');
                activeWork = null;
            } else {
                document.querySelectorAll('.image-container').forEach(container => {
                    container.classList.remove('active');
                });
                element.classList.add('active');
                activeWork = id;
            }
        }

        // 初始化导航
        function initializeNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    navItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                });
            });
        }

        // 迷宫相关函数
        function generateMaze() {
            console.log('开始生成迷宫...');
            maze = [];
            path = [];
            
            // 初始化迷宫
            for (let i = 0; i < mazeSize; i++) {
                maze[i] = [];
                for (let j = 0; j < mazeSize; j++) {
                    maze[i][j] = 1;
                }
            }

            function carve(x, y) {
                maze[x][y] = 0;
                const directions = [[0, 2], [2, 0], [0, -2], [-2, 0]];
                
                for (let i = directions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [directions[i], directions[j]] = [directions[j], directions[i]];
                }
                
                for (let [dx, dy] of directions) {
                    const newX = x + dx;
                    const newY = y + dy;
                    if (newX > 0 && newX < mazeSize - 1 && newY > 0 && newY < mazeSize - 1 && maze[newX][newY] === 1) {
                        maze[x + dx/2][y + dy/2] = 0;
                        carve(newX, newY);
                    }
                }
            }

            carve(1, 1);
            maze[1][1] = 2;
            maze[mazeSize-2][mazeSize-2] = 3;
            catPosition = [1, 1];
            displayMaze();
        }

        function displayMaze() {
            const mazeElement = document.getElementById('maze');
            mazeElement.style.gridTemplateColumns = `repeat(${mazeSize}, 1fr)`;
            mazeElement.innerHTML = '';
            
            for (let i = 0; i < mazeSize; i++) {
                for (let j = 0; j < mazeSize; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'maze-cell';
                    
                    if (maze[i][j] === 1) {
                        cell.classList.add('wall');
                    } else if (maze[i][j] === 2) {
                        cell.classList.add('start');
                    } else if (maze[i][j] === 3) {
                        cell.classList.add('end');
                    }
                    
                    if (i === catPosition[0] && j === catPosition[1]) {
                        cell.classList.add('cat');
                    }
                    
                    mazeElement.appendChild(cell);
                }
            }
        }

        function moveCat(direction) {
            if (isMoving) return;
            
            const [x, y] = catPosition;
            let newX = x;
            let newY = y;
            
            switch(direction) {
                case 'up': newX--; break;
                case 'down': newX++; break;
                case 'left': newY--; break;
                case 'right': newY++; break;
            }
            
            if (newX >= 0 && newX < mazeSize && newY >= 0 && newY < mazeSize && maze[newX][newY] !== 1) {
                isMoving = true;
                catPosition = [newX, newY];
                displayMaze();
                
                if (maze[newX][newY] === 3) {
                    showMazeCelebration();
                }
                
                setTimeout(() => {
                    isMoving = false;
                }, 300);
            }
        }

        function showMazeCelebration() {
            // 创建庆祝容器
            const celebrationContainer = document.createElement('div');
            celebrationContainer.className = 'maze-celebration-container';
            document.body.appendChild(celebrationContainer);

            // 添加背景遮罩
            const overlay = document.createElement('div');
            overlay.className = 'celebration-overlay';
            celebrationContainer.appendChild(overlay);

            // 添加烟花效果
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    createMazeFirework();
                }, i * 150);
            }

            // 添加彩带效果
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    createMazeConfetti();
                }, i * 50);
            }

            // 添加星星效果
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    createStar();
                }, i * 200);
            }

            // 添加通关文字
            const congratsText = document.createElement('div');
            congratsText.className = 'maze-congrats-text';
            congratsText.innerHTML = `
                <div class="maze-congrats-title">恭喜通关！🎉</div>
                <div class="maze-congrats-subtitle">你成功走出了迷宫！</div>
            `;
            celebrationContainer.appendChild(congratsText);

            // 播放庆祝音效
            const audio = new Audio('data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU' + 
                '...'); // 这里需要添加一个简短的庆祝音效的 base64 编码
            audio.play().catch(() => {});

            // 5秒后移除庆祝效果
            setTimeout(() => {
                celebrationContainer.remove();
            }, 5000);
        }

        function createMazeFirework() {
            const firework = document.createElement('div');
            firework.className = 'maze-firework';
            
            // 随机位置
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            
            // 随机颜色
            const colors = ['#FFD700', '#FF4500', '#00FF00', '#4169E1', '#FF69B4'];
            firework.style.background = `radial-gradient(circle, ${colors[Math.floor(Math.random() * colors.length)]}, transparent)`;
            
            document.body.appendChild(firework);
            
            // 动画结束后移除
            setTimeout(() => {
                firework.remove();
            }, 1500);
        }

        function createMazeConfetti() {
            const confetti = document.createElement('div');
            confetti.className = 'maze-confetti';
            
            // 随机形状和类型
            const types = ['circle', 'square', 'triangle', 'spiral', 'glitter', 'ribbon'];
            const type = types[Math.floor(Math.random() * types.length)];
            confetti.classList.add(type);
            
            // 随机颜色
            const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#FFD700', '#FF69B4', '#4169E1'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.backgroundColor = color;
            
            // 随机大小
            const size = Math.random() * 15 + 5;
            confetti.style.width = `${size}px`;
            confetti.style.height = `${size}px`;
            
            // 随机位置和旋转
            const x = Math.random() * window.innerWidth;
            const rotation = Math.random() * 360;
            const delay = Math.random() * 2;
            
            confetti.style.left = x + 'px';
            confetti.style.transform = `rotate(${rotation}deg)`;
            confetti.style.animationDelay = `${delay}s`;
            
            document.body.appendChild(confetti);
            
            // 动画结束后移除
            setTimeout(() => {
                confetti.remove();
            }, 5000);
        }

        function createStar() {
            const star = document.createElement('div');
            star.className = 'maze-star';
            
            // 随机位置
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            
            star.style.left = x + 'px';
            star.style.top = y + 'px';
            
            // 随机大小
            const size = Math.random() * 20 + 10;
            star.style.width = size + 'px';
            star.style.height = size + 'px';
            
            document.body.appendChild(star);
            
            // 动画结束后移除
            setTimeout(() => {
                star.remove();
            }, 2000);
        }

        // 宠物领养相关函数
        function showAdoptionModal() {
            console.log('显示领养弹窗');
            const overlay = document.getElementById('adoptionOverlay');
            const modal = document.getElementById('adoptionModal');
            
            if (!overlay || !modal) {
                console.error('找不到领养弹窗元素');
                return;
            }
            
            overlay.style.display = 'block';
            modal.style.display = 'block';
            
            // 添加显示动画
            requestAnimationFrame(() => {
                overlay.classList.add('show');
                modal.classList.add('show');
            });
        }

        function closeAdoptionModal() {
            const overlay = document.getElementById('adoptionOverlay');
            const modal = document.getElementById('adoptionModal');
            
            if (!overlay || !modal) {
                console.error('找不到领养弹窗元素');
                return;
            }
            
            overlay.classList.remove('show');
            modal.classList.remove('show');
            
            setTimeout(() => {
                overlay.style.display = 'none';
                modal.style.display = 'none';
            }, 300);
        }

        function adoptPet(petName) {
            if (!petName) {
                console.error('宠物名称无效');
                return;
            }

            console.log('开始领养宠物:', petName);
            
            // 创建庆祝动画
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                confetti.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
            
            // 初始化宠物状态
            adoptedPet = {
                name: petName,
                happiness: 100,
                hunger: 100,
                adoptionDate: new Date().toLocaleString()
            };
            
            // 更新宠物状态显示
            updatePetStatus();
            
            // 开始宠物状态监控
            startPetMonitoring();
            
            // 保存宠物状态到本地存储
            localStorage.setItem('adoptedPet', JSON.stringify(adoptedPet));
            
            // 创建动态小猫
            createActivePet();
            
            // 关闭领养弹窗
            closeAdoptionModal();
            
            // 显示成功消息
            alert(`恭喜你成功领养了${petName}！\n现在可以和它互动了！`);
        }

        // 创建动态小猫
        function createActivePet() {
            console.log('创建动态小猫');
            // 如果已经存在小猫，先移除
            const existingPets = document.querySelectorAll('#activePet');
            existingPets.forEach(pet => pet.remove());

            const activePet = document.createElement('div');
            activePet.id = 'activePet';
            activePet.className = 'active-pet';
            
            // 根据领养的小猫设置对应的图片
            if (adoptedPet) {
                switch(adoptedPet.name) {
                    case '灰灰':
                        activePet.style.backgroundImage = "url('public/小灰.png')";
                        break;
                    case '雪球':
                        activePet.style.backgroundImage = "url('public/雪球.png')";
                        break;
                    case '大橘':
                        activePet.style.backgroundImage = "url('public/大菊.png')";
                        break;
                }
            }
            
            // 设置初始位置
            const maxX = window.innerWidth - 100;
            const maxY = window.innerHeight - 100;
            activePet.style.left = (Math.random() * maxX) + 'px';
            activePet.style.top = (Math.random() * maxY) + 'px';
            
            // 添加点击事件
            activePet.addEventListener('click', function() {
                showPetInteractionOptions();
            });
            
            // 添加到页面
            document.body.appendChild(activePet);
            
            // 开始跟随鼠标移动
            startMouseFollowing(activePet);
        }

        // 开始跟随鼠标移动
        function startMouseFollowing(pet) {
            console.log('开始跟随鼠标移动');
            let targetX = 0;
            let targetY = 0;
            let currentX = parseInt(pet.style.left);
            let currentY = parseInt(pet.style.top);
            
            // 清除之前的移动间隔
            if (pet.dataset.moveInterval) {
                clearInterval(parseInt(pet.dataset.moveInterval));
            }
            
            // 存储鼠标位置
            document.addEventListener('mousemove', function(e) {
                targetX = e.clientX;
                targetY = e.clientY;
            });
            
            // 每100毫秒更新一次位置
            const moveInterval = setInterval(() => {
                // 计算当前位置到目标位置的距离
                const dx = targetX - currentX;
                const dy = targetY - currentY;
                
                // 如果距离足够大，开始移动
                if (Math.abs(dx) > 5 || Math.abs(dy) > 5) {
                    // 根据移动方向翻转小猫
                    if (dx < 0) {
                        pet.style.transform = 'scaleX(-1)';
                    } else {
                        pet.style.transform = 'scaleX(1)';
                    }
                    
                    // 平滑移动
                    currentX += dx * 0.1;
                    currentY += dy * 0.1;
                    
                    // 确保小猫在可视区域内
                    const maxX = window.innerWidth - 100;
                    const maxY = window.innerHeight - 100;
                    
                    currentX = Math.max(0, Math.min(currentX, maxX));
                    currentY = Math.max(0, Math.min(currentY, maxY));
                    
                    pet.style.left = currentX + 'px';
                    pet.style.top = currentY + 'px';
                }
            }, 100);
            
            // 存储interval ID，以便在需要时清除
            pet.dataset.moveInterval = moveInterval;
        }

        // 修改页面切换函数
        function showPage(pageId) {
            console.log('切换页面到:', pageId);
            // 隐藏所有页面
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });

            // 显示选中的页面
            const selectedPage = document.getElementById(pageId);
            if (selectedPage) {
                selectedPage.classList.add('active');
            }

            // 确保只有一个小猫
            const existingPets = document.querySelectorAll('#activePet');
            if (existingPets.length > 1) {
                // 如果存在多个小猫，只保留第一个，移除其他的
                for (let i = 1; i < existingPets.length; i++) {
                    existingPets[i].remove();
                }
            }

            // 确保小猫在页面切换后仍然存在
            const pet = document.getElementById('activePet');
            if (!pet && adoptedPet) {
                createActivePet();
            } else if (pet) {
                // 如果小猫存在，将其移动到新页面的合适位置
                const container = selectedPage.querySelector('.container');
                if (container) {
                    const rect = container.getBoundingClientRect();
                    const newX = rect.left + (rect.width / 2);
                    const newY = rect.top + (rect.height / 2);
                    pet.style.left = newX + 'px';
                    pet.style.top = newY + 'px';
                }
            }
        }

        // 在页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 如果已经领养了小猫，重新创建它
            try {
                const savedPet = localStorage.getItem('adoptedPet');
                if (savedPet) {
                    adoptedPet = JSON.parse(savedPet);
                    createActivePet();
                }
            } catch (error) {
                console.error('恢复宠物状态失败:', error);
            }
            
            // 监听窗口大小变化
            window.addEventListener('resize', function() {
                const pet = document.getElementById('activePet');
                if (pet) {
                    // 确保小猫在可视区域内
                    const maxX = window.innerWidth - 100;
                    const maxY = window.innerHeight - 100;
                    const currentX = parseInt(pet.style.left);
                    const currentY = parseInt(pet.style.top);
                    
                    if (currentX > maxX) pet.style.left = maxX + 'px';
                    if (currentY > maxY) pet.style.top = maxY + 'px';
                }
            });
            
            // 监听导航点击事件
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault(); // 阻止默认行为
                    const pageId = this.getAttribute('data-target');
                    if (pageId) {
                        showPage(pageId);
                    }
                });
            });
        });

        // 显示小猫互动选项
        function showPetInteractionOptions() {
            console.log('显示互动选项');
            const options = document.createElement('div');
            options.className = 'pet-interaction-options';
            options.innerHTML = `
                <div class="interaction-option" onclick="playWithPet()">陪玩</div>
                <div class="interaction-option" onclick="feedPet()">喂食</div>
                <div class="interaction-option" onclick="cancelAdoption()">取消领养</div>
            `;
            
            // 添加到页面
            document.body.appendChild(options);
            
            // 3秒后自动隐藏
            setTimeout(() => {
                options.remove();
            }, 3000);
        }

        // 陪玩功能
        function playWithPet() {
            const pet = document.getElementById('activePet');
            if (pet) {
                pet.classList.add('playing');
                setTimeout(() => {
                    pet.classList.remove('playing');
                }, 2000);
            }
        }

        // 喂食功能
        function feedPet() {
            const pet = document.getElementById('activePet');
            if (pet) {
                pet.classList.add('eating');
                setTimeout(() => {
                    pet.classList.remove('eating');
                }, 2000);
            }
        }

        // 取消领养功能
        function cancelAdoption() {
            // 移除小猫
            const pet = document.getElementById('activePet');
            if (pet) {
                pet.remove();
            }
            
            // 清除领养状态
            adoptedPet = null;
            localStorage.removeItem('adoptedPet');
            
            // 显示提示
            alert('已取消领养');
        }

        function updatePetStatus() {
            if (!adoptedPet) return;
            
            const petStatus = document.getElementById('petStatus');
            const petNameElem = document.getElementById('petName');
            const happinessBar = document.getElementById('happinessBar');
            const hungerBar = document.getElementById('hungerBar');
            const happinessValue = document.getElementById('happinessValue');
            const hungerValue = document.getElementById('hungerValue');
            const petMood = document.getElementById('petMood');
            const adoptedPetImage = document.getElementById('adoptedPetImage');
            
            petStatus.classList.add('show');
            adoptedPetImage.style.backgroundImage = getPetImage(adoptedPet.name);
            petNameElem.textContent = adoptedPet.name;
            
            happinessBar.style.width = `${adoptedPet.happiness}%`;
            hungerBar.style.width = `${adoptedPet.hunger}%`;
            
            happinessValue.textContent = Math.round(adoptedPet.happiness);
            hungerValue.textContent = Math.round(adoptedPet.hunger);
            
            updatePetMood();
        }

        function getPetImage(petName) {
            const images = {
                '灰灰': 'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="%23808080"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="%23808080"/><path d="M6,3 h4 v1 h-4 z" fill="%23808080"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="%23808080"/><circle cx="6" cy="8" r="1" fill="white"/><circle cx="10" cy="8" r="1" fill="white"/><path d="M7,10 h2 v1 h-2 z" fill="white"/></svg>\')',
                '橘子': 'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="%23FFA500"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="%23FFA500"/><path d="M6,3 h4 v1 h-4 z" fill="%23FFA500"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="%23FFA500"/><circle cx="6" cy="8" r="1" fill="white"/><circle cx="10" cy="8" r="1" fill="white"/><path d="M7,10 h2 v1 h-2 z" fill="white"/></svg>\')',
                '雪球': 'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3,6 h10 v5 h-2 v2 h-6 v-2 h-2 z" fill="white"/><path d="M4,4 h2 v2 h-2 z M10,4 h2 v2 h-2 z" fill="white"/><path d="M6,3 h4 v1 h-4 z" fill="white"/><path d="M3,8 h2 v1 h-2 z M11,8 h2 v1 h-2 z" fill="white"/><circle cx="6" cy="8" r="1" fill="%23666"/><circle cx="10" cy="8" r="1" fill="%23666"/><path d="M7,10 h2 v1 h-2 z" fill="%23666"/></svg>\')'
            };
            return images[petName] || images['灰灰'];
        }

        function startPetMonitoring() {
            if (petInterval) clearInterval(petInterval);
            
            petInterval = setInterval(() => {
                if (!adoptedPet) return;
                
                adoptedPet.happiness = Math.max(0, adoptedPet.happiness - 0.5);
                adoptedPet.hunger = Math.max(0, adoptedPet.hunger - 0.3);
                
                updatePetStatus();
                localStorage.setItem('adoptedPet', JSON.stringify(adoptedPet));
            }, 10000);
        }

        function updatePetMood() {
            if (!adoptedPet) return;
            
            const petMood = document.getElementById('petMood');
            const averageStatus = (adoptedPet.happiness + adoptedPet.hunger) / 2;
            
            if (averageStatus > 80) {
                petMood.textContent = '😊';
            } else if (averageStatus > 60) {
                petMood.textContent = '😌';
            } else if (averageStatus > 40) {
                petMood.textContent = '😐';
            } else if (averageStatus > 20) {
                petMood.textContent = '😟';
            } else {
                petMood.textContent = '😢';
            }
        }

        function playWithPet() {
            if (!adoptedPet) return;
            
            adoptedPet.happiness = Math.min(100, adoptedPet.happiness + 20);
            adoptedPet.hunger = Math.max(0, adoptedPet.hunger - 10);
            
            const adoptedPetImage = document.getElementById('adoptedPetImage');
            adoptedPetImage.style.transform = 'scale(1.2)';
            setTimeout(() => {
                adoptedPetImage.style.transform = 'scale(1)';
            }, 200);
            
            updatePetStatus();
            createFloatingEmoji('❤️');
        }

        function feedPet() {
            if (!adoptedPet) return;
            
            adoptedPet.hunger = Math.min(100, adoptedPet.hunger + 30);
            adoptedPet.happiness = Math.min(100, adoptedPet.happiness + 10);
            
            const adoptedPetImage = document.getElementById('adoptedPetImage');
            adoptedPetImage.style.transform = 'translateY(-10px)';
            setTimeout(() => {
                adoptedPetImage.style.transform = 'translateY(0)';
            }, 200);
            
            updatePetStatus();
            createFloatingEmoji('🍖');
        }

        function createFloatingEmoji(emoji) {
            const element = document.createElement('div');
            element.style.position = 'fixed';
            element.style.left = '50%';
            element.style.top = '50%';
            element.style.fontSize = '24px';
            element.style.pointerEvents = 'none';
            element.style.animation = 'float 1s ease-out forwards';
            element.textContent = emoji;
            document.body.appendChild(element);
            
            setTimeout(() => element.remove(), 1000);
        }

        // 树丛动画相关函数
        function initializeBushAnimation() {
            const bushContainer = document.querySelector('.bush-container');
            if (!bushContainer) {
                console.error('未找到灌木容器');
                return;
            }
            createRandomLeaves(bushContainer);
        }

        // 创建随机树叶
        function createRandomLeaves(container) {
            if (!container) {
                console.error('容器元素不存在');
                return;
            }

            const leafCount = 20;
            for (let i = 0; i < leafCount; i++) {
                const leaf = document.createElement('div');
                leaf.className = 'leaf';
                leaf.style.left = Math.random() * 100 + '%';
                leaf.style.animationDelay = Math.random() * 5 + 's';
                leaf.style.animationDuration = (Math.random() * 3 + 2) + 's';
                container.appendChild(leaf);
            }
        }

        // 添加留言花园相关函数
        function sendMessage() {
            const input = document.querySelector('.message-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // 使用addMessage函数添加消息
            addMessage(message);
            
            // 清空输入框
            input.value = '';
            
            // 创建发送动画
            const envelope = document.createElement('div');
            envelope.textContent = '✉️';
            envelope.style.position = 'fixed';
            envelope.style.fontSize = '24px';
            envelope.style.zIndex = '1000';
            envelope.style.transition = 'all 1s ease';
            
            const form = document.querySelector('.message-form');
            const formRect = form.getBoundingClientRect();
            const mailbox = document.querySelector('.mailbox');
            const mailboxRect = mailbox.getBoundingClientRect();
            
            envelope.style.left = `${formRect.right - 50}px`;
            envelope.style.top = `${formRect.top + 50}px`;
            document.body.appendChild(envelope);
            
            requestAnimationFrame(() => {
                envelope.style.left = `${mailboxRect.left + 15}px`;
                envelope.style.top = `${mailboxRect.top + 15}px`;
                envelope.style.transform = 'scale(0.5)';
            });
            
            setTimeout(() => {
                envelope.remove();
                showSuccessMessage();
            }, 1000);
        }

        function showSuccessMessage() {
            const success = document.createElement('div');
            success.textContent = '留言成功！';
            success.style.position = 'fixed';
            success.style.left = '50%';
            success.style.top = '50%';
            success.style.transform = 'translate(-50%, -50%)';
            success.style.background = 'rgba(76, 175, 80, 0.9)';
            success.style.color = 'white';
            success.style.padding = '1rem 2rem';
            success.style.borderRadius = '2rem';
            success.style.animation = 'fadeInOut 2s ease forwards';
            
            document.body.appendChild(success);
            setTimeout(() => success.remove(), 2000);
        }

        // 添加消息的函数
        function addMessage(content) {
            if (!content.trim()) return; // 如果消息为空，不添加
            
            const newMessage = {
                content: content,
                time: new Date().toLocaleString()
            };
            mailboxMessages.push(newMessage);
            localStorage.setItem('mailboxMessages', JSON.stringify(mailboxMessages));
            displayMessages();
            updateMailboxCount();
        }

        // 显示消息的函数
        function displayMessages() {
            const modal = document.getElementById('messages-modal');
            if (!modal) return;
            
            let messagesHtml = '';
            mailboxMessages.forEach((msg, index) => {
                messagesHtml += `
                    <div class="message-item" style="margin-bottom: 15px; padding: 10px; background-color: rgba(255, 255, 255, 0.9); border-radius: 8px; border: 1px solid #eee;">
                        <div class="message-content" style="color: var(--dark-green); margin-bottom: 8px; word-wrap: break-word; white-space: pre-wrap; font-size: 14px; display: block;">${msg.content}</div>
                        <div class="message-time" style="color: #666; font-size: 12px;">${msg.time}</div>
                    </div>
                `;
            });
            
            modal.innerHTML = messagesHtml;
        }

        // 切换消息显示
        function toggleMessages() {
            const modal = document.getElementById('messages-modal');
            if (modal.style.display === 'none' || !modal.style.display) {
                displayMessages();
                modal.style.display = 'block';
            } else {
                modal.style.display = 'none';
            }
        }

        // 更新邮箱数字
        function updateMailboxCount() {
            const countElement = document.querySelector('.mailbox-count');
            if (countElement) {
                countElement.textContent = mailboxMessages.length;
            }
        }

        // 初始化时更新邮箱数字
        document.addEventListener('DOMContentLoaded', () => {
            updateMailboxCount();
        });

        function createFlowers() {
            const mailbox = document.querySelector('.mailbox');
            const colors = ['#FF69B4', '#FFB6C1', '#FFC0CB', '#DB7093'];
            const numFlowers = 5;
            
            for (let i = 0; i < numFlowers; i++) {
                const flower = document.createElement('div');
                flower.className = 'flower';
                flower.innerHTML = '🌸';
                flower.style.position = 'absolute';
                
                const angle = (i / numFlowers) * Math.PI * 2;
                const radius = 40;
                const x = Math.cos(angle) * radius;
                const y = Math.sin(angle) * radius;
                
                flower.style.left = `${x + 30}px`;
                flower.style.top = `${y + 30}px`;
                flower.style.animationDelay = `${i * 0.2}s`;
                
                mailbox.appendChild(flower);
            }
        }

        // 添加秘密花园背景动画
        function initializeGardenBackground() {
            const gardens = document.querySelectorAll('.garden-background');
            gardens.forEach(garden => {
                createVines(garden);
                createFlowers(garden);
                createButterflies(garden);
            });
        }

        function createVines(garden) {
            const numVines = 8;
            for (let i = 0; i < numVines; i++) {
                const vine = document.createElement('div');
                vine.className = 'vine';
                vine.style.left = `${Math.random() * 100}%`;
                vine.style.setProperty('--vine-height', `${150 + Math.random() * 200}px`);
                vine.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;
                vine.style.animationDelay = `${i * 0.5}s`;
                garden.appendChild(vine);
            }
        }

        function createFlowers(garden) {
            const numFlowers = 12;
            const flowerTypes = ['red', 'pink', 'yellow', 'white'];
            const flowerEmojis = ['🌹', '🌸', '🌼', '🌺'];
            
            for (let i = 0; i < numFlowers; i++) {
                const flower = document.createElement('div');
                const typeIndex = Math.floor(Math.random() * flowerTypes.length);
                flower.className = `garden-flower ${flowerTypes[typeIndex]}`;
                flower.textContent = flowerEmojis[typeIndex];
                flower.style.left = `${Math.random() * 90 + 5}%`;
                flower.style.top = `${Math.random() * 90 + 5}%`;
                flower.style.animationDelay = `${i * 0.3}s`;
                garden.appendChild(flower);
            }
        }

        function createButterflies(garden) {
            const numButterflies = 5;
            for (let i = 0; i < numButterflies; i++) {
                const butterfly = document.createElement('div');
                butterfly.className = 'butterfly';
                butterfly.textContent = '🦋';
                butterfly.style.setProperty('--hue', `${Math.random() * 360}deg`);
                butterfly.style.animationDelay = `${i * 2}s`;
                garden.appendChild(butterfly);
            }
        }

        // 添加流动树叶背景初始化
        function initializeFloatingLeaves() {
            const container = document.getElementById('floatingLeaves');
            const numLeaves = 20;
            
            for (let i = 0; i < numLeaves; i++) {
                const leaf = document.createElement('div');
                leaf.className = 'floating-leaf';
                
                // 随机起始位置和延迟
                leaf.style.left = `${Math.random() * 100}%`;
                leaf.style.top = `${Math.random() * 100}%`;
                leaf.style.animationDelay = `${Math.random() * 15}s`;
                
                // 随机大小和旋转
                const scale = 0.5 + Math.random() * 1;
                const rotation = Math.random() * 360;
                leaf.style.transform = `scale(${scale}) rotate(${rotation}deg)`;
                
                container.appendChild(leaf);
            }
        }

        // 添加动态小猫行为
        function createActivePet() {
            console.log('创建动态小猫');
            // 如果已经存在小猫，先移除
            const existingPets = document.querySelectorAll('#activePet');
            existingPets.forEach(pet => pet.remove());

            const activePet = document.createElement('div');
            activePet.id = 'activePet';
            activePet.className = 'active-pet';
            
            // 根据领养的小猫设置对应的图片
            if (adoptedPet) {
                switch(adoptedPet.name) {
                    case '灰灰':
                        activePet.style.backgroundImage = "url('public/小灰.png')";
                        break;
                    case '雪球':
                        activePet.style.backgroundImage = "url('public/雪球.png')";
                        break;
                    case '大橘':
                        activePet.style.backgroundImage = "url('public/大菊.png')";
                        break;
                }
            }
            
            // 设置初始位置
            const maxX = window.innerWidth - 100;
            const maxY = window.innerHeight - 100;
            activePet.style.left = (Math.random() * maxX) + 'px';
            activePet.style.top = (Math.random() * maxY) + 'px';
            
            // 添加点击事件
            activePet.addEventListener('click', function() {
                // 显示互动选项
                showPetInteractionOptions();
            });
            
            // 添加到页面
            document.body.appendChild(activePet);
            
            // 开始随机移动
            startPetMovement(activePet);
        }

        // 更新样式
        const style = document.createElement('style');
        style.textContent = `
            .active-pet {
                position: absolute;
                width: 100px;
                height: 100px;
            background-size: contain;
            background-repeat: no-repeat;
                background-position: center;
            cursor: pointer;
                transition: all 0.5s ease;
            z-index: 1000;
            }
            
            .active-pet:hover {
                transform: scale(1.1);
            }
        `;
        document.head.appendChild(style);

        function startPetMovement(pet) {
            let currentBehavior = '';
            let currentX = parseFloat(pet.style.left);
            let currentY = parseFloat(pet.style.top);
            
            setInterval(() => {
                const container = document.querySelector('.container');
                const maxX = container.offsetWidth - 100;
                const maxY = container.offsetHeight - 100;
                
                // 随机行为
                const behavior = Math.random();
                const newBehavior = behavior < 0.3 ? 'sleeping' : behavior < 0.6 ? 'playing' : 'moving';
                
                if (currentBehavior !== newBehavior) {
                    currentBehavior = newBehavior;
                    
                    switch(newBehavior) {
                        case 'sleeping':
                            pet.className = `active-pet ${getPetClass(adoptedPet.name)} sleeping`;
                            break;
                            
                        case 'playing':
                            pet.className = `active-pet ${getPetClass(adoptedPet.name)} playing`;
                            break;
                            
                        case 'moving':
                            pet.className = `active-pet ${getPetClass(adoptedPet.name)}`;
                            const newX = Math.random() * maxX;
                            const newY = Math.random() * maxY;
                            
                            // 根据移动方向翻转小猫
                            if (newX < currentX) {
                                pet.style.transform = 'scaleX(-1)';
                            } else {
                                pet.style.transform = 'scaleX(1)';
                            }
                            
                            pet.style.left = newX + 'px';
                            pet.style.top = newY + 'px';
                            
                            currentX = newX;
                            currentY = newY;
                            break;
                    }
                }
            }, 3000);
        }

        function getPetClass(petName) {
            switch(petName) {
                case '灰灰': return 'gray';
                case '橘子': return 'orange';
                case '雪球': return 'white';
                default: return 'gray';
            }
        }

        // 图片展示相关变量和函数
        let currentImageIndex = 0;
        let images = [];
        let imageLikes = JSON.parse(localStorage.getItem('imageLikes') || '{}');

        // 初始化图片展示功能
        document.addEventListener('DOMContentLoaded', () => {
            // 获取日常生活图片的点击事件
            const dailyLifeImage = document.querySelector('.gallery-item img[alt="日常生活"]');
            if (dailyLifeImage) {
                dailyLifeImage.parentElement.addEventListener('click', () => {
                    images = [
                        'public/day/微信图片_20250402150341.jpg',
                        'public/day/微信图片_20250402150353.jpg',
                        'public/day/微信图片_20250402150359.jpg',
                        'public/day/微信图片_20250402150405.jpg',
                        'public/day/微信图片_20250402150411.jpg',
                        'public/day/微信图片_20250402150417.jpg',
                        'public/day/微信图片_20250402150427.jpg',
                        'public/day/微信图片_20250402150509.jpg',
                        'public/day/微信图片_20250402150514.jpg',
                        'public/day/微信图片_20250402150519.jpg',
                        'public/day/微信图片_20250402150823.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取个人写真图片的点击事件
            const portraitImage = document.querySelector('.gallery-item img[alt="个人写真"]');
            if (portraitImage) {
                portraitImage.parentElement.addEventListener('click', () => {
                    images = [
                        'public/xiezhen/微信图片_20250402152038.jpg',
                        'public/xiezhen/微信图片_20250402152033.jpg',
                        'public/xiezhen/微信图片_20250402152029.jpg',
                        'public/xiezhen/微信图片_20250402152025.jpg',
                        'public/xiezhen/微信图片_20250402152021.jpg',
                        'public/xiezhen/微信图片_20250402152018.jpg',
                        'public/xiezhen/微信图片_20250402152014.jpg',
                        'public/xiezhen/微信图片_20250402152009.jpg',
                        'public/xiezhen/微信图片_20250402151957.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取旅行图片的点击事件
            const travelImage = document.querySelector('.gallery-item img[alt="旅行"]');
            if (travelImage) {
                travelImage.parentElement.addEventListener('click', () => {
                    images = [
                        'public/travel/微信图片_20250402153351.jpg',
                        'public/travel/微信图片_20250402153347.jpg',
                        'public/travel/微信图片_20250402153344.jpg',
                        'public/travel/微信图片_20250402153340.jpg',
                        'public/travel/微信图片_20250402153336.jpg',
                        'public/travel/微信图片_20250402153332.jpg',
                        'public/travel/微信图片_20250402153327.jpg',
                        'public/travel/微信图片_20250402153324.jpg',
                        'public/travel/微信图片_20250402153320.jpg',
                        'public/travel/微信图片_20250402153316.jpg',
                        'public/travel/微信图片_20250402153312.jpg',
                        'public/travel/微信图片_20250402153308.jpg',
                        'public/travel/微信图片_20250402153257.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取兴趣爱好图片的点击事件
            const hobbyImage = document.querySelector('.gallery-item img[alt="兴趣爱好"]');
            if (hobbyImage) {
                hobbyImage.parentElement.addEventListener('click', () => {
                    images = [
                        'public/like/微信图片_20250402154457.jpg',
                        'public/like/微信图片_20250402154452.jpg',
                        'public/like/微信图片_20250402154447.jpg',
                        'public/like/微信图片_20250402154441.jpg',
                        'public/like/微信图片_20250402154437.jpg',
                        'public/like/微信图片_20250402154426.jpg',
                        'public/like/微信图片_20250402154420.jpg',
                        'public/like/微信图片_20250402154409.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取风景图片的点击事件
            const sceneryImage = document.querySelector('.gallery-item img[alt="风景"]');
            if (sceneryImage) {
                sceneryImage.parentElement.addEventListener('click', () => {
                    images = [
                        'public/fengjing/微信图片_20250402154950.jpg',
                        'public/fengjing/微信图片_20250402154946.jpg',
                        'public/fengjing/微信图片_20250402154942.jpg',
                        'public/fengjing/微信图片_20250402154939.jpg',
                        'public/fengjing/微信图片_20250402154935.jpg',
                        'public/fengjing/微信图片_20250402154931.jpg',
                        'public/fengjing/微信图片_20250402154928.jpg',
                        'public/fengjing/微信图片_20250402154924.jpg',
                        'public/fengjing/微信图片_20250402154915.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取美食图片的点击事件
            const foodImage = document.querySelector('.gallery-item img[alt="美食"]');
            if (foodImage) {
                foodImage.parentElement.addEventListener('click', () => {
                    images = [
                        'public/food/微信图片_20250402155627.jpg',
                        'public/food/微信图片_20250402155623.jpg',
                        'public/food/微信图片_20250402155619.jpg',
                        'public/food/微信图片_20250402155615.jpg',
                        'public/food/微信图片_20250402155604.jpg',
                        'public/food/微信图片_20250402155553.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取作品一的点击事件
            const work1Image = document.querySelector('.image-container[data-work="1"]');
            if (work1Image) {
                work1Image.addEventListener('click', () => {
                    images = [
                        'public/zuopin1/微信图片_20250402161644.jpg',
                        'public/zuopin1/微信图片_20250402161640.jpg',
                        'public/zuopin1/微信图片_20250402161635.jpg',
                        'public/zuopin1/微信图片_20250402161631.jpg',
                        'public/zuopin1/微信图片_20250402161627.jpg',
                        'public/zuopin1/微信图片_20250402161624.jpg',
                        'public/zuopin1/微信图片_20250402161620.jpg',
                        'public/zuopin1/微信图片_20250402161616.jpg',
                        'public/zuopin1/微信图片_20250402161602.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取作品二的点击事件
            const work2Image = document.querySelector('.image-container[data-work="2"]');
            if (work2Image) {
                work2Image.addEventListener('click', () => {
                    images = [
                        'public/zuopin2/微信图片_20250402161340.jpg',
                        'public/zuopin2/微信图片_20250402161107.jpg',
                        'public/zuopin2/微信图片_20250402161016.jpg',
                        'public/zuopin2/微信图片_20250402161012.jpg',
                        'public/zuopin2/微信图片_20250402161008.jpg',
                        'public/zuopin2/微信图片_20250402161004.jpg',
                        'public/zuopin2/微信图片_20250402161000.jpg',
                        'public/zuopin2/微信图片_20250402160948.jpg'
                    ];
                    showImageModal(0);
                });
            }

            // 获取作品三的点击事件
            const work3Image = document.querySelector('.image-container[data-work="3"]');
            if (work3Image) {
                work3Image.addEventListener('click', () => {
                    images = [
                        'public/zuopin3/微信图片_20250402160800.jpg',
                        'public/zuopin3/微信图片_20250402160629.jpg',
                        'public/zuopin3/微信图片_20250402160624.jpg',
                        'public/zuopin3/微信图片_20250402160619.jpg',
                        'public/zuopin3/微信图片_20250402160613.jpg',
                        'public/zuopin3/微信图片_20250402160600.jpg'
                    ];
                    showImageModal(0);
                });
            }
        });

        function showImageModal(index) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const likeButton = document.querySelector('.like-button');
            const likeCount = document.querySelector('.like-count');
            
            if (images.length === 0) {
                alert('没有找到图片');
                return;
            }
            
            currentImageIndex = index;
            modalImage.src = images[currentImageIndex];
            
            // 更新点赞状态
            const currentImage = images[currentImageIndex];
            const likes = imageLikes[currentImage] || 0;
            likeCount.textContent = likes;
            likeButton.classList.toggle('liked', likes > 0);
            
            modal.style.display = 'block';
            modal.classList.add('show');

            // 添加装饰花朵和蝴蝶
            createModalDecorations(modal);
            
            // 创建弹幕容器
            const danmakuContainer = document.createElement('div');
            danmakuContainer.className = 'danmaku-container';
            modal.querySelector('.image-container').appendChild(danmakuContainer);
            
            // 创建弹幕输入框
            const danmakuInputContainer = document.createElement('div');
            danmakuInputContainer.className = 'danmaku-input-container';
            danmakuInputContainer.innerHTML = `
                <input type="text" class="danmaku-input" placeholder="发送弹幕...">
                <button class="danmaku-send">发送</button>
            `;
            modal.appendChild(danmakuInputContainer);
            
            // 添加弹幕发送事件
            const sendButton = danmakuInputContainer.querySelector('.danmaku-send');
            const input = danmakuInputContainer.querySelector('.danmaku-input');
            
            sendButton.addEventListener('click', () => sendDanmaku(input, danmakuContainer));
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendDanmaku(input, danmakuContainer);
                }
            });
        }

        function createModalDecorations(modal) {
            // 创建花朵
            for (let i = 0; i < 5; i++) {
                const flower = document.createElement('div');
                flower.className = 'modal-flower';
                flower.textContent = '🌸';
                flower.style.left = `${Math.random() * 100}%`;
                flower.style.top = `${Math.random() * 100}%`;
                flower.style.animationDelay = `${Math.random() * 2}s`;
                modal.appendChild(flower);
            }
            
            // 创建蝴蝶
            for (let i = 0; i < 3; i++) {
                const butterfly = document.createElement('div');
                butterfly.className = 'modal-butterfly';
                butterfly.textContent = '🦋';
                butterfly.style.left = `${Math.random() * 100}%`;
                butterfly.style.top = `${Math.random() * 100}%`;
                butterfly.style.animationDelay = `${Math.random() * 2}s`;
                modal.appendChild(butterfly);
            }
        }

        function sendDanmaku(input, container) {
            const text = input.value.trim();
            if (!text) return;
            
            
            const danmaku = document.createElement('div');
            danmaku.className = 'danmaku';
            danmaku.textContent = text;
            
            // 随机垂直位置
            const top = Math.random() * 80 + 10;
            danmaku.style.top = `${top}%`;
            
            container.appendChild(danmaku);
            
            // 动画结束后移除弹幕
            danmaku.addEventListener('animationend', () => {
                danmaku.remove();
            });
            
            input.value = '';
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.classList.remove('show');
            
            // 移除所有装饰元素
            modal.querySelectorAll('.modal-flower, .modal-butterfly, .danmaku-container, .danmaku-input-container').forEach(el => el.remove());
            
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        function prevImage() {
            currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
            document.getElementById('modalImage').src = images[currentImageIndex];
        }

        function nextImage() {
            currentImageIndex = (currentImageIndex + 1) % images.length;
            document.getElementById('modalImage').src = images[currentImageIndex];
        }

        // 添加键盘控制
        document.addEventListener('keydown', (e) => {
            const modal = document.getElementById('imageModal');
            if (modal.style.display === 'block') {
                if (e.key === 'ArrowLeft') {
                    prevImage();
                } else if (e.key === 'ArrowRight') {
                    nextImage();
                } else if (e.key === 'Escape') {
                    closeImageModal();
                }
            }
        });

        function handleLike() {
            const likeButton = document.querySelector('.like-button');
            const likeCount = document.querySelector('.like-count');
            const currentImage = images[currentImageIndex];
            
            // 播放点赞音效
            const audio = new Audio('data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU' + 
                '...'); // 这里需要添加一个简短的开心音效的 base64 编码
            
            // 更新点赞状态
            if (imageLikes[currentImage]) {
                imageLikes[currentImage]--;
                likeButton.classList.remove('liked');
            } else {
                imageLikes[currentImage] = 1;
                likeButton.classList.add('liked');
                audio.play().catch(() => {}); // 播放音效
                createLikeParticles(); // 创建粒子效果
            }
            
            likeCount.textContent = imageLikes[currentImage];
            localStorage.setItem('imageLikes', JSON.stringify(imageLikes));
        }

        function createLikeParticles() {
            const modal = document.querySelector('.image-modal');
            const colors = ['#FF69B4', '#FFB6C1', '#FFC0CB', '#DB7093'];
            
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('div');
                particle.className = 'like-particle';
                particle.innerHTML = '❤️';
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.bottom = '20%';
                particle.style.fontSize = `${Math.random() * 20 + 10}px`;
                particle.style.color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.animationDelay = `${Math.random() * 0.5}s`;
                
                modal.appendChild(particle);
                
                // 动画结束后移除粒子
                setTimeout(() => particle.remove(), 1000);
            }
        }

        // 删除语音识别相关代码
        let recognition = null;
        let isVoiceInputActive = false;

        // DeepSeek API配置
        const DEEPSEEK_API_KEY = 'sk-638ddd655d77443495447295497cb5df';
        const DEEPSEEK_API_URL = 'https://api.deepseek.com/v1/chat/completions';
        
        // AI对话栏相关函数
        function toggleAIChatBar() {
            const chatBar = document.querySelector('.ai-chat-bar');
            chatBar.classList.toggle('minimized');
        }
        
        function handleAIKeyPress(event) {
            if (event.key === 'Enter') {
                sendAIMessage();
            }
        }
        
        function addAIMessage(text, isUser) {
            const messagesContainer = document.getElementById('aiMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `ai-message ${isUser ? 'user-message' : ''}`;
            
            messageDiv.innerHTML = `
                <div class="ai-avatar ${isUser ? 'user-avatar' : ''}">${isUser ? '你' : '李诗淼'}</div>
                <div class="ai-text ${isUser ? 'user-text' : ''}">${text}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function showTypingIndicator() {
            const messagesContainer = document.getElementById('aiMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            
            typingDiv.innerHTML = `
                <div class="ai-avatar">李诗淼</div>
                <div class="ai-text">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        async function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (message) {
                // 添加用户消息
                addAIMessage(message, true);
                input.value = '';
                
                // 显示正在输入状态
                showTypingIndicator();
                
                try {
                    // 调用DeepSeek API获取回复
                    const response = await fetch(DEEPSEEK_API_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${DEEPSEEK_API_KEY}`
                        },
                        body: JSON.stringify({
                            model: "deepseek-chat",
                            messages: [
                                {
                                    role: "system",
                                    content: "你现在是李诗淼，一个温柔可爱的女孩。你要表现出以下特点：1. 说话温柔细腻，带有一些可爱的语气词；2. 性格开朗活泼，但有时也会害羞；3. 用词简单自然，偶尔会使用一些可爱的表情符号；4. 对人有礼貌，会关心对方；5. 回答要简短有趣，不要太长。请用这种风格来回答用户的问题。"
                                },
                                {
                                    role: "user",
                                    content: message
                                }
                            ],
                            temperature: 0.7,
                            max_tokens: 500
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error('API请求失败');
                    }
                    
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    
                    // 移除输入状态显示
                    removeTypingIndicator();
                    
                    // 显示AI回复
                    addAIMessage(aiResponse, false);
                } catch (error) {
                    console.error('API调用错误:', error);
                    
                    // 移除输入状态显示
                    removeTypingIndicator();
                    
                    // 显示错误消息
                    addAIMessage('抱歉，我现在有点累，稍后再和你聊天吧~', false);
                }
            }
        }
        
        // 确保DOM加载完成后再执行
        document.addEventListener('DOMContentLoaded', function() {
            // ... existing code ...
        });

        // 添加消息的函数
        function addMessage(content) {
            if (!content.trim()) return; // 如果消息为空，不添加
            
            const newMessage = {
                content: content,
                time: new Date().toLocaleString()
            };
            mailboxMessages.push(newMessage);
            localStorage.setItem('mailboxMessages', JSON.stringify(mailboxMessages));
            displayMessages();
            updateMailboxCount();
        }

        // 切换消息显示
        function toggleMessages() {
            const modal = document.getElementById('messages-modal');
            if (modal.style.display === 'none' || !modal.style.display) {
                displayMessages();
                modal.style.display = 'block';
            } else {
                modal.style.display = 'none';
            }
        }

        // 更新邮箱数字
        function updateMailboxCount() {
            const countElement = document.querySelector('.mailbox-count');
            if (countElement) {
                countElement.textContent = mailboxMessages.length;
            }
        }

        // 初始化时更新邮箱数字
        document.addEventListener('DOMContentLoaded', () => {
            updateMailboxCount();
        });

        // 添加摄像头相关变量
        let video = null;
        let stream = null;
        let canvas = null;
        let ctx = null;
        let isGestureControlActive = false;
        let gestureDetectionInterval = null;

        // 初始化摄像头
        async function initCamera() {
            try {
                console.log('正在初始化摄像头...');
                
                // 创建视频元素
                if (!video) {
                    video = document.createElement('video');
                    video.id = 'cameraFeed';
                    video.style.position = 'fixed';
                    video.style.bottom = '20px';
                    video.style.right = '20px';
                    video.style.width = '200px';
                    video.style.height = '150px';
                    video.style.transform = 'scaleX(-1)'; // 镜像显示
                    video.style.display = 'none';
                    video.style.zIndex = '1000';
                    video.style.border = '2px solid var(--dark-green)';
                    video.style.borderRadius = '10px';
                    document.body.appendChild(video);
                    console.log('视频元素已创建');
                }

                // 创建canvas用于分析视频帧
                if (!canvas) {
                    canvas = document.createElement('canvas');
                    canvas.width = 200;
                    canvas.height = 150;
                    ctx = canvas.getContext('2d');
                    console.log('Canvas已创建');
                }

                // 获取摄像头权限并开始视频流
                console.log('正在请求摄像头权限...');
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: 200, 
                        height: 150,
                        facingMode: 'user' // 指定使用前置摄像头
                    } 
                });
                console.log('摄像头权限已获取');
                
                if (video.srcObject !== stream) {
                    video.srcObject = stream;
                }
                
                // 等待视频开始播放
                await new Promise((resolve) => {
                    video.onloadedmetadata = () => {
                        video.play().then(() => {
                            console.log('视频开始播放');
                            resolve();
                        }).catch(error => {
                            console.error('视频播放失败:', error);
                        });
                    };
                });

                // 显示视频元素
                video.style.display = 'block';
                console.log('摄像头已启动');

                // 开始手势检测
                startGestureDetection();
            } catch (error) {
                console.error('摄像头初始化失败:', error);
                alert('无法访问摄像头，请确保已授予摄像头权限。');
                isGestureControlActive = false;
                const gestureButton = document.getElementById('gestureControl');
                if (gestureButton) {
                    gestureButton.textContent = '开始手势控制';
                    gestureButton.classList.remove('active');
                }
            }
        }

        // 停止摄像头
        function stopCamera() {
            console.log('正在停止摄像头...');
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            if (video) {
                video.style.display = 'none';
                video.srcObject = null;
            }
            if (gestureDetectionInterval) {
                clearInterval(gestureDetectionInterval);
                gestureDetectionInterval = null;
            }
            isGestureControlActive = false;
            console.log('摄像头已停止');
        }

        // 切换手势控制
        function toggleGestureControl() {
            console.log('切换手势控制状态:', !isGestureControlActive);
            const gestureButton = document.getElementById('gestureControl');
            if (!isGestureControlActive) {
                isGestureControlActive = true;
                gestureButton.textContent = '停止手势控制';
                gestureButton.classList.add('active');
                initCamera();
                document.getElementById('mazeInfo').textContent = '将手放在摄像头画面中心，然后向想要移动的方向移动';
            } else {
                isGestureControlActive = false;
                gestureButton.textContent = '开始手势控制';
                gestureButton.classList.remove('active');
                stopCamera();
                document.getElementById('mazeInfo').textContent = '使用方向键或手势控制小猫移动！';
            }
        }

        // 添加手势控制按钮
        function addGestureControlButton() {
            console.log('正在添加手势控制按钮...');
            const controlsDiv = document.querySelector('.maze-controls');
            if (controlsDiv) {
                // 检查是否已经存在手势控制按钮
                if (!document.getElementById('gestureControl')) {
                    const gestureButton = document.createElement('button');
                    gestureButton.id = 'gestureControl';
                    gestureButton.textContent = '开始手势控制';
                    gestureButton.onclick = toggleGestureControl;
                    gestureButton.style.marginLeft = '10px';
                    gestureButton.style.padding = '8px 16px';
                    gestureButton.style.backgroundColor = 'var(--light-green)';
                    gestureButton.style.color = 'var(--dark-green)';
                    gestureButton.style.border = 'none';
                    gestureButton.style.borderRadius = '20px';
                    gestureButton.style.cursor = 'pointer';
                    gestureButton.style.transition = 'all 0.3s ease';
                    controlsDiv.appendChild(gestureButton);
                    console.log('手势控制按钮已添加');
                }
            } else {
                console.error('未找到迷宫控制区域');
            }
        }

        // 在页面加载时添加手势控制按钮
        document.addEventListener('DOMContentLoaded', () => {
            console.log('页面加载完成，初始化手势控制...');
            addGestureControlButton();
        });

        // 开始手势检测
        function startGestureDetection() {
            if (gestureDetectionInterval) {
                clearInterval(gestureDetectionInterval);
            }

            gestureDetectionInterval = setInterval(() => {
                if (!ctx || !video || !isGestureControlActive) return;

                // 将视频帧绘制到canvas
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // 检测手指位置
                const fingerSize = 30;
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                
                // 检测中心区域
                const centerData = ctx.getImageData(centerX - fingerSize/2, centerY - fingerSize/2, fingerSize, fingerSize);
                let centerBrightness = 0;
                for (let i = 0; i < centerData.data.length; i += 4) {
                    centerBrightness += (centerData.data[i] + centerData.data[i + 1] + centerData.data[i + 2]) / 3;
                }
                centerBrightness /= (centerData.data.length / 4);

                // 如果检测到手指
                if (centerBrightness > 50) {
                    // 检测手指移动方向
                    const directions = {
                        up: { x: centerX, y: centerY - fingerSize },
                        down: { x: centerX, y: centerY + fingerSize },
                        left: { x: centerX - fingerSize, y: centerY },
                        right: { x: centerX + fingerSize, y: centerY }
                    };

                    let maxDiff = 0;
                    let detectedDirection = null;

                    // 检查四个方向的亮度差异
                    for (const [direction, pos] of Object.entries(directions)) {
                        const data = ctx.getImageData(pos.x - fingerSize/2, pos.y - fingerSize/2, fingerSize, fingerSize);
                        let brightness = 0;
                        for (let i = 0; i < data.data.length; i += 4) {
                            brightness += (data.data[i] + data.data[i + 1] + data.data[i + 2]) / 3;
                        }
                        brightness /= (data.data.length / 4);

                        const diff = Math.abs(brightness - centerBrightness);
                        if (diff > maxDiff && brightness > 50) {
                            maxDiff = diff;
                            detectedDirection = direction;
                        }
                    }

                    // 如果检测到方向，移动小猫
                    if (detectedDirection) {
                        moveCat(detectedDirection);
                        console.log('检测到方向:', detectedDirection, '亮度差异:', maxDiff);
                    }
                }
            }, 50); // 更快的检测频率
        }

        function handleAdoptionClick() {
            console.log('点击了领养按钮');
            const overlay = document.getElementById('adoptionOverlay');
            const modal = document.getElementById('adoptionModal');
            
            if (!overlay || !modal) {
                console.error('找不到领养弹窗元素');
                return;
            }
            
            overlay.style.display = 'block';
            modal.style.display = 'block';
            
            // 添加显示动画
            requestAnimationFrame(() => {
                overlay.classList.add('show');
                modal.classList.add('show');
            });
        }

        function checkWin() {
            if (playerX === exitX && playerY === exitY) {
                isGameActive = false;
                showMazeCelebration();
            }
        }

        function showMazeCelebration() {
            // 创建庆祝容器
            const celebrationContainer = document.createElement('div');
            celebrationContainer.className = 'maze-celebration-container';
            document.body.appendChild(celebrationContainer);

            // 添加背景遮罩
            const overlay = document.createElement('div');
            overlay.className = 'celebration-overlay';
            celebrationContainer.appendChild(overlay);

            // 添加烟花效果
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    createMazeFirework();
                }, i * 150);
            }

            // 添加彩带效果
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    createMazeConfetti();
                }, i * 50);
            }

            // 添加星星效果
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    createStar();
                }, i * 200);
            }

            // 添加通关文字
            const congratsText = document.createElement('div');
            congratsText.className = 'maze-congrats-text';
            congratsText.innerHTML = `
                <div class="maze-congrats-title">恭喜通关！🎉</div>
                <div class="maze-congrats-subtitle">你成功走出了迷宫！</div>
            `;
            celebrationContainer.appendChild(congratsText);

            // 播放庆祝音效
            const audio = new Audio('data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU' + 
                '...'); // 这里需要添加一个简短的庆祝音效的 base64 编码
            audio.play().catch(() => {});

            // 5秒后移除庆祝效果
            setTimeout(() => {
                celebrationContainer.remove();
            }, 5000);
        }

        function createMazeFirework() {
            const firework = document.createElement('div');
            firework.className = 'maze-firework';
            
            // 随机位置
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            
            // 随机颜色
            const colors = ['#FFD700', '#FF4500', '#00FF00', '#4169E1', '#FF69B4'];
            firework.style.background = `radial-gradient(circle, ${colors[Math.floor(Math.random() * colors.length)]}, transparent)`;
            
            document.body.appendChild(firework);
            
            // 动画结束后移除
            setTimeout(() => {
                firework.remove();
            }, 1500);
        }

        function createMazeConfetti() {
            const confetti = document.createElement('div');
            confetti.className = 'maze-confetti';
            
            // 随机形状和类型
            const types = ['circle', 'square', 'triangle', 'spiral', 'glitter', 'ribbon'];
            const type = types[Math.floor(Math.random() * types.length)];
            confetti.classList.add(type);
            
            // 随机颜色
            const colors = ['#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF', '#FFD700', '#FF69B4', '#4169E1'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.backgroundColor = color;
            
            // 随机大小
            const size = Math.random() * 15 + 5;
            confetti.style.width = `${size}px`;
            confetti.style.height = `${size}px`;
            
            // 随机位置和旋转
            const x = Math.random() * window.innerWidth;
            const rotation = Math.random() * 360;
            const delay = Math.random() * 2;
            
            confetti.style.left = x + 'px';
            confetti.style.transform = `rotate(${rotation}deg)`;
            confetti.style.animationDelay = `${delay}s`;
            
            document.body.appendChild(confetti);
            
            // 动画结束后移除
            setTimeout(() => {
                confetti.remove();
            }, 5000);
        }

        function createStar() {
            const star = document.createElement('div');
            star.className = 'maze-star';
            
            // 随机位置
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            
            star.style.left = x + 'px';
            star.style.top = y + 'px';
            
            // 随机大小
            const size = Math.random() * 20 + 10;
            star.style.width = size + 'px';
            star.style.height = size + 'px';
            
            document.body.appendChild(star);
            
            // 动画结束后移除
            setTimeout(() => {
                star.remove();
            }, 2000);
        }

        // 添加迷宫庆祝动画的样式
        const mazeCelebrationStyles = `
            .maze-celebration-container {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1000;
            }

            .celebration-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(5px);
            }

            .maze-congrats-text {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                text-align: center;
                z-index: 1001;
            }

            .maze-congrats-title {
                font-size: 64px;
                font-weight: bold;
                color: #FFD700;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
                margin-bottom: 20px;
                animation: bounce 1s infinite;
            }

            .maze-congrats-subtitle {
                font-size: 24px;
                color: white;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            }

            .maze-firework {
                position: fixed;
                width: 5px;
                height: 5px;
                border-radius: 50%;
                animation: mazeExplode 1.5s forwards;
            }

            .maze-confetti {
                position: fixed;
                width: 10px;
                height: 10px;
                animation: mazeFall 3s linear forwards;
            }

            .maze-confetti.circle {
                border-radius: 50%;
            }

            .maze-confetti.triangle {
                width: 0;
                height: 0;
                border-left: 5px solid transparent;
                border-right: 5px solid transparent;
                border-bottom: 10px solid currentColor;
                background: none;
            }

            .maze-star {
                position: fixed;
                background: #FFD700;
                clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
                animation: mazeTwinkle 2s infinite;
            }

            @keyframes bounce {
                0%, 100% { transform: translate(-50%, -50%) scale(1); }
                50% { transform: translate(-50%, -50%) scale(1.2); }
            }

            @keyframes mazeExplode {
                0% { transform: scale(1); opacity: 1; }
                100% { transform: scale(30); opacity: 0; }
            }

            @keyframes mazeFall {
                0% { transform: translateY(-100px) rotate(0deg); }
                100% { transform: translateY(100vh) rotate(360deg); }
            }

            @keyframes mazeTwinkle {
                0%, 100% { opacity: 1; transform: scale(1); }
                50% { opacity: 0.5; transform: scale(0.8); }
            }
        `;

        // 添加样式到页面
        const styleSheet = document.createElement('style');
        styleSheet.textContent = mazeCelebrationStyles;
        document.head.appendChild(styleSheet);

        // 创建手势反馈元素
        const gestureFeedback = document.createElement('div');
        gestureFeedback.className = 'gesture-feedback';
        document.body.appendChild(gestureFeedback);

        function showGestureFeedback(text) {
            gestureFeedback.textContent = text;
            gestureFeedback.classList.add('show');
            setTimeout(() => {
                gestureFeedback.classList.remove('show');
            }, 2000);
        }

        // 修改手势处理函数
        function handleZoomIn() {
            showGestureFeedback('放大');
            // 执行放大操作
        }

        function handleZoomOut() {
            showGestureFeedback('缩小');
            // 执行缩小操作
        }

        function handleRotation(angle) {
            showGestureFeedback(angle > 0 ? '顺时针旋转' : '逆时针旋转');
            // 执行旋转操作
        }

        function handlePan(touchPoints) {
            showGestureFeedback('平移');
            // 执行平移操作
        }

        // 标签点赞功能
        document.addEventListener('DOMContentLoaded', function() {
            const tags = document.querySelectorAll('.tag');
            const MAX_SCALE = 2; // 最大放大倍数
            const INITIAL_SCALE = 1; // 初始大小

            tags.forEach(tag => {
                tag.addEventListener('click', function() {
                    // 获取当前大小
                    const currentSize = parseFloat(this.style.transform) || INITIAL_SCALE;
                    let newSize;
                    
                    // 如果当前大小已经达到最大，则重置
                    if (currentSize >= MAX_SCALE) {
                        newSize = INITIAL_SCALE;
                        // 添加重置动画
                        this.style.animation = 'resetAnimation 0.5s ease';
                    } else {
                        // 否则增加大小
                        newSize = currentSize + 0.1;
                        // 添加点赞动画
                        this.style.animation = 'likeAnimation 0.5s ease';
                    }
                    
                    // 应用新的变换
                    this.style.transform = `scale(${newSize})`;
                    
                    // 动画结束后恢复浮动动画
                    setTimeout(() => {
                        this.style.animation = 'floatAnimation 3s infinite ease-in-out';
                    }, 500);
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            // ... existing code ...
            
            // 为每个标签添加点击事件
            document.querySelectorAll('.tag').forEach(tag => {
                tag.addEventListener('click', function(e) {
                    // 阻止事件冒泡
                    e.stopPropagation();
                    
                    // 获取点赞计数元素
                    const likeCount = this.querySelector('.like-count');
                    let count = parseInt(likeCount.textContent) || 0;
                    count++;
                    
                    // 更新点赞数
                    likeCount.textContent = count;
                    likeCount.style.opacity = '1';
                    
                    // 添加弹跳动画
                    likeCount.style.animation = 'countBounce 0.5s ease';
                    setTimeout(() => {
                        likeCount.style.animation = '';
                    }, 500);
                    
                    // 创建爱心元素
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                    
                    // 设置爱心的初始位置
                    const rect = this.getBoundingClientRect();
                    heart.style.left = `${rect.left + rect.width/2 - 12}px`;
                    heart.style.top = `${rect.top + rect.height/2 - 12}px`;
                    
                    // 添加到页面
                    document.body.appendChild(heart);
                    
                    // 触发动画
                    requestAnimationFrame(() => {
                        heart.style.animation = 'heartFloat 1s forwards';
                    });
                    
                    // 动画结束后移除爱心
                    setTimeout(() => {
                        heart.remove();
                    }, 1000);
                    
                    // 添加点击缩放效果
                    this.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 200);
                });
            });
        });

        // Face++ API配置
        const FACE_API_KEY = '27SLmG8dL7md9hGtv6Su3SiVriZYpKme';
        const FACE_API_SECRET = 'kRegMphzgXgjQQeA2-56V4pZHKv3P1o8';
        const FACE_API_URL = 'https://api-cn.faceplusplus.com/facepp/v3/detect';

        // 表情映射
        const emotionToEmoji = {
            happiness: ['😊', '🌸', '🍰', '🎈'],
            sadness: ['😢', '☔', '🌧️', '🫂'],
            neutral: ['😌', '🍀', '🌿', '💫'],
            surprise: ['😲', '✨', '🎉', '🎊'],
            anger: ['😠', '⚡', '🔥', '💢'],
            disgust: ['😖', '🌪️', '🍂', '💨'],
            fear: ['😨', '❄️', '🌙', '🌫️']
        };

        async function analyzePhoto(photoDataUrl) {
            try {
                // 将base64图片数据转换为blob
                const response = await fetch(photoDataUrl);
                const blob = await response.blob();

                // 创建FormData对象
                const formData = new FormData();
                formData.append('api_key', FACE_API_KEY);
                formData.append('api_secret', FACE_API_SECRET);
                formData.append('image_file', blob);
                formData.append('return_attributes', 'emotion');

                // 调用Face++ API
                const result = await fetch(FACE_API_URL, {
                    method: 'POST',
                    body: formData
                });

                const data = await result.json();
                return data.faces?.[0]?.attributes?.emotion || null;
            } catch (error) {
                console.error('表情识别失败:', error);
                return null;
            }
        }

        function getEmotionEmojis(emotions) {
            if (!emotions) return [];
            
            // 找出最主要的情绪
            let maxEmotion = Object.entries(emotions).reduce((a, b) => 
                a[1] > b[1] ? a : b
            )[0].toLowerCase();
            
            return emotionToEmoji[maxEmotion] || emotionToEmoji.neutral;
        }

        function createFloatingEmojis(container, emojis) {
            emojis.forEach((emoji, index) => {
                const emojiElement = document.createElement('div');
                emojiElement.className = 'floating-emoji';
                emojiElement.textContent = emoji;
                
                // 随机位置和动画延迟
                const angle = (index / emojis.length) * 2 * Math.PI;
                const radius = 50;
                const left = 50 + radius * Math.cos(angle);
                const top = 50 + radius * Math.sin(angle);
                
                emojiElement.style.cssText = `
                    position: absolute;
                    left: ${left}%;
                    top: ${top}%;
                    font-size: 24px;
                    animation: floatEmoji 3s infinite ${index * 0.5}s;
                    z-index: 2;
                `;
                
                container.appendChild(emojiElement);
            });
        }

        async function savePhoto() {
            const photoPreview = document.getElementById('photoPreview');
            const photoWall = document.getElementById('photoWall');
            const savedPhotosTitle = document.getElementById('savedPhotosTitle');
            
            // 分析照片中的表情
            const emotions = await analyzePhoto(photoPreview.src);
            const emojis = getEmotionEmojis(emotions);
            
            // 创建新的照片元素
            const photoItem = document.createElement('div');
            photoItem.className = 'photo-item';
            
            // 生成唯一ID
            const photoId = 'photo_' + Date.now();
            photoItem.id = photoId;
            
            // 获取当前日期时间
            const now = new Date();
            const dateStr = now.toLocaleDateString('zh-CN') + ' ' + 
                         now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
            
            // 设置照片HTML
            photoItem.innerHTML = `
                <div class="photo-container" style="position: relative; width: 100%; height: 100%;">
                    <img src="${photoPreview.src}" alt="保存的照片">
                    <button class="delete-btn" onclick="deletePhoto('${photoId}')">×</button>
                    <div class="photo-date">${dateStr}</div>
                </div>
            `;
            
            // 添加表情装饰
            const photoContainer = photoItem.querySelector('.photo-container');
            createFloatingEmojis(photoContainer, emojis);
            
            // 添加到照片墙
            photoWall.insertBefore(photoItem, photoWall.firstChild);
            savedPhotosTitle.style.display = 'block';
            
            // 保存到本地存储
            saveToLocalStorage(photoId, {
                src: photoPreview.src,
                date: dateStr,
                emojis: emojis
            });
            
            // 关闭相机并重置界面
            if (window.cameraStream) {
                window.cameraStream.getTracks().forEach(track => track.stop());
                window.cameraStream = null;
            }
            
            document.getElementById('previewSection').style.display = 'none';
            document.getElementById('retakeBtn').style.display = 'none';
            document.getElementById('saveBtn').style.display = 'none';
            
            // 显示保存成功提示
            alert('照片保存成功！');
        }

        // 修改加载保存的照片的函数
        window.addEventListener('load', function() {
            const savedPhotos = JSON.parse(localStorage.getItem('savedPhotos') || '{}');
            const photoWall = document.getElementById('photoWall');
            const savedPhotosTitle = document.getElementById('savedPhotosTitle');
            
            if (Object.keys(savedPhotos).length > 0) {
                savedPhotosTitle.style.display = 'block';
                
                Object.entries(savedPhotos).forEach(([id, data]) => {
                    const photoItem = document.createElement('div');
                    photoItem.className = 'photo-item';
                    photoItem.id = id;
                    
                    photoItem.innerHTML = `
                        <div class="photo-container" style="position: relative; width: 100%; height: 100%;">
                            <img src="${data.src}" alt="保存的照片">
                            <button class="delete-btn" onclick="deletePhoto('${id}')">×</button>
                            <div class="photo-date">${data.date}</div>
                        </div>
                    `;
                    
                    // 如果有表情数据，添加表情装饰
                    if (data.emojis) {
                        const photoContainer = photoItem.querySelector('.photo-container');
                        createFloatingEmojis(photoContainer, data.emojis);
                    }
                    
                    photoWall.appendChild(photoItem);
                });
            }
        });

        // 添加到已有的脚本中
        const API_KEY = 'live_okaGEkjIEiSU3bRsxaffC7B2DgEfupahYbCrTaE0o8gKLlnYHuYnpKxise9d8s7n';
        const dogImage = document.getElementById('randomDogImage');
        const generateBtn = document.getElementById('generateDogBtn');
        const voiceControlBtn = document.getElementById('voiceControlBtn');
        const voiceStatus = document.getElementById('voiceStatus');
        const loadingSpinner = document.querySelector('.loading-spinner');

        // 初始化语音识别
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'zh-CN';

                recognition.onstart = () => {
                    voiceStatus.textContent = '正在聆听...';
                    voiceControlBtn.style.backgroundColor = 'var(--bright-pink)';
                };

                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    voiceStatus.textContent = `您说: ${transcript}`;
                    searchDogByDescription(transcript);
                };

                recognition.onerror = (event) => {
                    voiceStatus.textContent = '语音识别出错，请重试';
                    voiceControlBtn.style.backgroundColor = 'var(--dark-green)';
                };

                recognition.onend = () => {
                    voiceControlBtn.style.backgroundColor = 'var(--dark-green)';
                };
            } else {
                voiceStatus.textContent = '您的浏览器不支持语音识别';
            }
        }

        // 根据描述搜索小狗
        async function searchDogByDescription(description) {
            try {
                const response = await fetch('https://api.thedogapi.com/v1/breeds/search?q=' + encodeURIComponent(description), {
                    headers: {
                        'x-api-key': API_KEY
                    }
                });
                
                if (!response.ok) {
                    throw new Error('搜索失败');
                }
                
                const breeds = await response.json();
                if (breeds.length > 0) {
                    // 如果找到匹配的品种，获取该品种的图片
                    const breedId = breeds[0].id;
                    const imageResponse = await fetch(`https://api.thedogapi.com/v1/images/search?breed_id=${breedId}`, {
                        headers: {
                            'x-api-key': API_KEY
                        }
                    });
                    
                    if (!imageResponse.ok) {
                        throw new Error('获取图片失败');
                    }
                    
                    const imageData = await imageResponse.json();
                    if (imageData.length > 0) {
                        dogImage.src = imageData[0].url;
                        dogImage.style.display = 'block';
                        return breeds[0].name;
                    }
                }
                
                // 如果没有找到匹配的品种或图片，获取随机图片
                await fetchRandomDog();
                return '';
            } catch (error) {
                console.error('Error fetching dog image:', error);
                // 如果搜索失败，获取随机图片
                await fetchRandomDog();
                return '';
            }
        }

        async function fetchRandomDog() {
            try {
                loadingSpinner.style.display = 'block';
                dogImage.style.display = 'none';
                
                const response = await fetch('https://api.thedogapi.com/v1/images/search', {
                    headers: {
                        'x-api-key': API_KEY
                    }
                });
                
                if (!response.ok) {
                    throw new Error('获取图片失败');
                }
                
                const data = await response.json();
                dogImage.src = data[0].url;
                dogImage.style.display = 'block';
            } catch (error) {
                console.error('Error:', error);
                alert('获取图片失败，请稍后重试');
            } finally {
                loadingSpinner.style.display = 'none';
            }
        }

        // 初始化语音识别
        initSpeechRecognition();

        // 添加语音控制按钮事件
        voiceControlBtn.addEventListener('click', () => {
            if (recognition) {
                recognition.start();
            }
        });

        // ... existing code ...
    </script>
</body>
</html> 
